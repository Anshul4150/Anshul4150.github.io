---
jupyter:
  kaggle:
    accelerator: nvidiaTeslaT4
    dataSources:
    - datasetId: 4498747
      sourceId: 7705679
      sourceType: datasetVersion
    - datasetId: 4564591
      sourceId: 7796657
      sourceType: datasetVersion
    - modelInstanceId: 22015
      sourceId: 26154
      sourceType: modelInstanceVersion
    dockerImageVersionId: 30683
    isGpuEnabled: true
    isInternetEnabled: true
    language: python
    sourceType: notebook
  kernelspec:
    display_name: Python 3 (ipykernel)
    language: python
    name: python3
  language_info:
    codemirror_mode:
      name: ipython
      version: 3
    file_extension: .py
    mimetype: text/x-python
    name: python
    nbconvert_exporter: python
    pygments_lexer: ipython3
    version: 3.11.5
  nbformat: 4
  nbformat_minor: 5
  papermill:
    default_parameters: {}
    duration: 851.416188
    end_time: "2024-04-14T21:51:30.465317"
    environment_variables: {}
    input_path: \_\_notebook\_\_.ipynb
    output_path: \_\_notebook\_\_.ipynb
    parameters: {}
    start_time: "2024-04-14T21:37:19.049129"
    version: 2.5.0
  widgets:
    application/vnd.jupyter.widget-state+json:
      state:
        012443aa613948f98cce75a8fe80248a:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: FloatProgressModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: FloatProgressModel
            _view_module: \@jupyter-widgets/controls
            _view_module_version: 1.5.0
            _view_name: ProgressView
            bar_style: success
            layout: IPY_MODEL_1bcbf5d4a37848169d58d426d8c756a7
            max: 53
            min: 0
            orientation: horizontal
            style: IPY_MODEL_fe3a4d331904408e93ba9de7c3ef13a2
            value: 53
        0126dc7b2b994778a8b555ee6c848e46:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: ProgressStyleModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: ProgressStyleModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: StyleView
        01f84f42f6f24003b5bafa1e295066f7:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: FloatProgressModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: FloatProgressModel
            _view_module: \@jupyter-widgets/controls
            _view_module_version: 1.5.0
            _view_name: ProgressView
            bar_style: success
            layout: IPY_MODEL_9fe6b28a56d543ddb32f7220d940bb17
            max: 116
            min: 0
            orientation: horizontal
            style: IPY_MODEL_5bbaee4c56814cf4aaf64a852c56050d
            value: 116
        0268c7990dab4834ae9796c80b7c814b:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: HTMLModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: HTMLModel
            _view_module: \@jupyter-widgets/controls
            _view_module_version: 1.5.0
            _view_name: HTMLView
            layout: IPY_MODEL_d6466824a236418b9b281a800e7c4e7e
            placeholder: ​
            style: IPY_MODEL_5b8432e076f34769b75a22d92839cc8e
            value: " 363/363 \\[00:00&lt;00:00, 31.9kB/s\\]"
        0581b220947045f7b8fbb8f15a507c2f:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: ProgressStyleModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: ProgressStyleModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: StyleView
        08be1f140a33421ea4b03a2b981f075f:
          model_module: \@jupyter-widgets/base
          model_module_version: 1.2.0
          model_name: LayoutModel
          state:
            _model_module: \@jupyter-widgets/base
            _model_module_version: 1.2.0
            _model_name: LayoutModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: LayoutView
        0a883eb65e0140bb9947ead458475cc2:
          model_module: \@jupyter-widgets/base
          model_module_version: 1.2.0
          model_name: LayoutModel
          state:
            _model_module: \@jupyter-widgets/base
            _model_module_version: 1.2.0
            _model_name: LayoutModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: LayoutView
        0d5bbf9f5a344194a645cf03ccec4b36:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: ProgressStyleModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: ProgressStyleModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: StyleView
        1068b4bcb8b744b0abd00e2f3edb3d25:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: HTMLModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: HTMLModel
            _view_module: \@jupyter-widgets/controls
            _view_module_version: 1.5.0
            _view_name: HTMLView
            layout: IPY_MODEL_12eecc1ac68245209faacc68893fbcc2
            placeholder: ​
            style: IPY_MODEL_c7d5482753cd4adcb16dfe19fcd38c5a
            value: " 4/4 \\[02:08&lt;00:00, 28.97s/it\\]"
        10942534bda04ebbb98019eb03af63c1:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: DescriptionStyleModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: DescriptionStyleModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: StyleView
        1107cace99b549adaa2908d26090595a:
          model_module: \@jupyter-widgets/base
          model_module_version: 1.2.0
          model_name: LayoutModel
          state:
            _model_module: \@jupyter-widgets/base
            _model_module_version: 1.2.0
            _model_name: LayoutModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: LayoutView
        123049f8b50c4aa390b2730628a7e1dc:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: HBoxModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: HBoxModel
            _view_module: \@jupyter-widgets/controls
            _view_module_version: 1.5.0
            _view_name: HBoxView
            children:
            - IPY_MODEL_af090bf079ee427ea6aaa5b89c3d93c3
            - IPY_MODEL_db1c4df02b97484e918ee9740a2c2411
            - IPY_MODEL_43a96f206aef40e1bfee9667179b0e0a
            layout: IPY_MODEL_9030bb21c98e4afe80d66555f075ba1f
        12eecc1ac68245209faacc68893fbcc2:
          model_module: \@jupyter-widgets/base
          model_module_version: 1.2.0
          model_name: LayoutModel
          state:
            _model_module: \@jupyter-widgets/base
            _model_module_version: 1.2.0
            _model_name: LayoutModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: LayoutView
        16e366561b294c6788d8f4525d1a0230:
          model_module: \@jupyter-widgets/base
          model_module_version: 1.2.0
          model_name: LayoutModel
          state:
            _model_module: \@jupyter-widgets/base
            _model_module_version: 1.2.0
            _model_name: LayoutModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: LayoutView
        184628c80d7c45fea4cd95fc1910f70b:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: DescriptionStyleModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: DescriptionStyleModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: StyleView
        1a74971b70ac40b2ad96dfa610c3d80b:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: HTMLModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: HTMLModel
            _view_module: \@jupyter-widgets/controls
            _view_module_version: 1.5.0
            _view_name: HTMLView
            layout: IPY_MODEL_2d8546e9eec64e93b9cf3e3d6b7283a4
            placeholder: ​
            style: IPY_MODEL_4f65c0167b7948619954fc3dde5c4f3d
            value: "tokenizer.json: 100%"
        1a8735baeabf4b3c91d141f71d129f9b:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: DescriptionStyleModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: DescriptionStyleModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: StyleView
        1ad175ff12104aaab9e52297472c0c17:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: DescriptionStyleModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: DescriptionStyleModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: StyleView
        1bb98e28459c48709ea484d240c6d94f:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: ProgressStyleModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: ProgressStyleModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: StyleView
        1bcbf5d4a37848169d58d426d8c756a7:
          model_module: \@jupyter-widgets/base
          model_module_version: 1.2.0
          model_name: LayoutModel
          state:
            _model_module: \@jupyter-widgets/base
            _model_module_version: 1.2.0
            _model_name: LayoutModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: LayoutView
        1c1585ff5ba64eb2982c0eddcc3c4e52:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: HBoxModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: HBoxModel
            _view_module: \@jupyter-widgets/controls
            _view_module_version: 1.5.0
            _view_name: HBoxView
            children:
            - IPY_MODEL_1a74971b70ac40b2ad96dfa610c3d80b
            - IPY_MODEL_cfe17233609c4ae7940135b58ebc1c50
            - IPY_MODEL_f18eaf0578cf4b21932b7985124c0e30
            layout: IPY_MODEL_2a5fcf9a55cf4d0fb2c97361d802b570
        20e8779132df48889711147cbb69dc6a:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: ProgressStyleModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: ProgressStyleModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: StyleView
        2470a2c5bb214efaadefbf538f6931e8:
          model_module: \@jupyter-widgets/base
          model_module_version: 1.2.0
          model_name: LayoutModel
          state:
            _model_module: \@jupyter-widgets/base
            _model_module_version: 1.2.0
            _model_name: LayoutModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: LayoutView
        292b7b7879054a829fbac0818659c76b:
          model_module: \@jupyter-widgets/base
          model_module_version: 1.2.0
          model_name: LayoutModel
          state:
            _model_module: \@jupyter-widgets/base
            _model_module_version: 1.2.0
            _model_name: LayoutModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: LayoutView
        2a57359348f24f129083671c2a466dfb:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: HBoxModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: HBoxModel
            _view_module: \@jupyter-widgets/controls
            _view_module_version: 1.5.0
            _view_name: HBoxView
            children:
            - IPY_MODEL_c6cc0f22281e4d48aa5dbcef26cb02be
            - IPY_MODEL_a32b643fa8da46439e7cf1113e3731f7
            - IPY_MODEL_0268c7990dab4834ae9796c80b7c814b
            layout: IPY_MODEL_08be1f140a33421ea4b03a2b981f075f
        2a5fcf9a55cf4d0fb2c97361d802b570:
          model_module: \@jupyter-widgets/base
          model_module_version: 1.2.0
          model_name: LayoutModel
          state:
            _model_module: \@jupyter-widgets/base
            _model_module_version: 1.2.0
            _model_name: LayoutModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: LayoutView
        2d8546e9eec64e93b9cf3e3d6b7283a4:
          model_module: \@jupyter-widgets/base
          model_module_version: 1.2.0
          model_name: LayoutModel
          state:
            _model_module: \@jupyter-widgets/base
            _model_module_version: 1.2.0
            _model_name: LayoutModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: LayoutView
        2ff8d0f6dc474cb89622c6112fc038e5:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: DescriptionStyleModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: DescriptionStyleModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: StyleView
        3477df3357df42439acc9c1bc2fc1252:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: DescriptionStyleModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: DescriptionStyleModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: StyleView
        3d44868eb4984b058a2f3c5d576c2e00:
          model_module: \@jupyter-widgets/base
          model_module_version: 1.2.0
          model_name: LayoutModel
          state:
            _model_module: \@jupyter-widgets/base
            _model_module_version: 1.2.0
            _model_name: LayoutModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: LayoutView
        3dadf3732dcc40a0be94169e1ed2b5e4:
          model_module: \@jupyter-widgets/base
          model_module_version: 1.2.0
          model_name: LayoutModel
          state:
            _model_module: \@jupyter-widgets/base
            _model_module_version: 1.2.0
            _model_name: LayoutModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: LayoutView
        3f991f5f0c77446da207b6efeb585fd9:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: HBoxModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: HBoxModel
            _view_module: \@jupyter-widgets/controls
            _view_module_version: 1.5.0
            _view_name: HBoxView
            children:
            - IPY_MODEL_c86d5b9e9b2945bda487a4d17a04fca5
            - IPY_MODEL_dcace745abaa4f42bb9be50072ac9408
            - IPY_MODEL_54433fafd79f4655aaf43d8fb9266ae2
            layout: IPY_MODEL_8e8b1397889346499d2412b9d4355393
        3fd1db37e8704b7bab7f4eb5f436b3ef:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: DescriptionStyleModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: DescriptionStyleModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: StyleView
        43a96f206aef40e1bfee9667179b0e0a:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: HTMLModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: HTMLModel
            _view_module: \@jupyter-widgets/controls
            _view_module_version: 1.5.0
            _view_name: HTMLView
            layout: IPY_MODEL_930fb09dde6c45b39fc13430e1eba2e1
            placeholder: ​
            style: IPY_MODEL_9fb141280a6341d2b45242b84e7acc52
            value: " 349/349 \\[00:00&lt;00:00, 26.3kB/s\\]"
        458066ab2f9e49cfabbd798ac8b848fa:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: ProgressStyleModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: ProgressStyleModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: StyleView
        47b9538d76594755a281f60ddf4e5a92:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: HTMLModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: HTMLModel
            _view_module: \@jupyter-widgets/controls
            _view_module_version: 1.5.0
            _view_name: HTMLView
            layout: IPY_MODEL_cae3ba2c821c43d4a7f79425fa64b978
            placeholder: ​
            style: IPY_MODEL_3fd1db37e8704b7bab7f4eb5f436b3ef
            value: " 190/190 \\[00:00&lt;00:00, 16.9kB/s\\]"
        4c9cb7f3481f4f4bb5e956b91f152ca9:
          model_module: \@jupyter-widgets/base
          model_module_version: 1.2.0
          model_name: LayoutModel
          state:
            _model_module: \@jupyter-widgets/base
            _model_module_version: 1.2.0
            _model_name: LayoutModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: LayoutView
        4d16efaac068411b808af9acbe88047b:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: ProgressStyleModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: ProgressStyleModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: StyleView
        4f1b99487925445894a56095523446f0:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: HBoxModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: HBoxModel
            _view_module: \@jupyter-widgets/controls
            _view_module_version: 1.5.0
            _view_name: HBoxView
            children:
            - IPY_MODEL_afa9068869bd4119a1556ccace36d211
            - IPY_MODEL_012443aa613948f98cce75a8fe80248a
            - IPY_MODEL_c6d481df4e234d9d9f7e6a5d806e3226
            layout: IPY_MODEL_d6b5eaf2ec854806b173e31804119425
        4f65c0167b7948619954fc3dde5c4f3d:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: DescriptionStyleModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: DescriptionStyleModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: StyleView
        4fa9b811cec64f67b30d1f990d753b47:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: DescriptionStyleModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: DescriptionStyleModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: StyleView
        5401853058ae4560932e1595b346208d:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: HBoxModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: HBoxModel
            _view_module: \@jupyter-widgets/controls
            _view_module_version: 1.5.0
            _view_name: HBoxView
            children:
            - IPY_MODEL_dd153e6e7934471683e693804a65518a
            - IPY_MODEL_d1402121b8324664b523f4fb348db59a
            - IPY_MODEL_f34f3fc4bb78413682c1cdc2b6a476a0
            layout: IPY_MODEL_d80ac356109448ec96ec284307511ceb
        54433fafd79f4655aaf43d8fb9266ae2:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: HTMLModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: HTMLModel
            _view_module: \@jupyter-widgets/controls
            _view_module_version: 1.5.0
            _view_name: HTMLView
            layout: IPY_MODEL_3dadf3732dcc40a0be94169e1ed2b5e4
            placeholder: ​
            style: IPY_MODEL_84812e669af44679961d5987cffb46b0
            value: " 232k/232k \\[00:00&lt;00:00, 5.20MB/s\\]"
        5470e863f8724e3ca685cb563ac6e58d:
          model_module: \@jupyter-widgets/base
          model_module_version: 1.2.0
          model_name: LayoutModel
          state:
            _model_module: \@jupyter-widgets/base
            _model_module_version: 1.2.0
            _model_name: LayoutModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: LayoutView
        547b7e8f86cd4712b6bc9dbaefd378e3:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: DescriptionStyleModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: DescriptionStyleModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: StyleView
        554742353df04a57bbb1850f1ae0ee70:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: HBoxModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: HBoxModel
            _view_module: \@jupyter-widgets/controls
            _view_module_version: 1.5.0
            _view_name: HBoxView
            children:
            - IPY_MODEL_56043c107c644d999878a84c01ca98a2
            - IPY_MODEL_7f43ec74ad774eb2b55333f24da33e7d
            - IPY_MODEL_afd317cd9bb047a089dcd927be11a9d0
            layout: IPY_MODEL_67644781402b44b7929481e8ddcf2fbc
        56043c107c644d999878a84c01ca98a2:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: HTMLModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: HTMLModel
            _view_module: \@jupyter-widgets/controls
            _view_module_version: 1.5.0
            _view_name: HTMLView
            layout: IPY_MODEL_b82fbf0300aa411ab350cb471a1a544b
            placeholder: ​
            style: IPY_MODEL_97bc56549f27455f956492d5c7acab94
            value: "config.json: 100%"
        561ab234f50640c29c13d28cd3b93d00:
          model_module: \@jupyter-widgets/base
          model_module_version: 1.2.0
          model_name: LayoutModel
          state:
            _model_module: \@jupyter-widgets/base
            _model_module_version: 1.2.0
            _model_name: LayoutModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: LayoutView
        562ef17eefa14e3387cec6f6a412cf70:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: HTMLModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: HTMLModel
            _view_module: \@jupyter-widgets/controls
            _view_module_version: 1.5.0
            _view_name: HTMLView
            layout: IPY_MODEL_f9fbead6425a45f5989835efe1e44f55
            placeholder: ​
            style: IPY_MODEL_ffe13121fd6e4b98a7e2b979e12d4f34
            value: " 166/166 \\[00:00&lt;00:00, 1833.38 examples/s\\]"
        5b8432e076f34769b75a22d92839cc8e:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: DescriptionStyleModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: DescriptionStyleModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: StyleView
        5bbaee4c56814cf4aaf64a852c56050d:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: ProgressStyleModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: ProgressStyleModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: StyleView
        5e403655059048c7b1a937231f24cfd0:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: HBoxModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: HBoxModel
            _view_module: \@jupyter-widgets/controls
            _view_module_version: 1.5.0
            _view_name: HBoxView
            children:
            - IPY_MODEL_8bf033c33e474b19b9c564fa9100c183
            - IPY_MODEL_b857a42632c94656885cdd67b9390e9f
            - IPY_MODEL_79b216552c9846db93cd80fefb9da055
            layout: IPY_MODEL_292b7b7879054a829fbac0818659c76b
        636fe39acf4a4eba89acced9c6548d2d:
          model_module: \@jupyter-widgets/base
          model_module_version: 1.2.0
          model_name: LayoutModel
          state:
            _model_module: \@jupyter-widgets/base
            _model_module_version: 1.2.0
            _model_name: LayoutModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: LayoutView
        667a5200c3be487288e3024ff3bb6178:
          model_module: \@jupyter-widgets/base
          model_module_version: 1.2.0
          model_name: LayoutModel
          state:
            _model_module: \@jupyter-widgets/base
            _model_module_version: 1.2.0
            _model_name: LayoutModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: LayoutView
        67644781402b44b7929481e8ddcf2fbc:
          model_module: \@jupyter-widgets/base
          model_module_version: 1.2.0
          model_name: LayoutModel
          state:
            _model_module: \@jupyter-widgets/base
            _model_module_version: 1.2.0
            _model_name: LayoutModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: LayoutView
        69174407dcf746d4b46592e7af96459f:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: HTMLModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: HTMLModel
            _view_module: \@jupyter-widgets/controls
            _view_module_version: 1.5.0
            _view_name: HTMLView
            layout: IPY_MODEL_636fe39acf4a4eba89acced9c6548d2d
            placeholder: ​
            style: IPY_MODEL_b9f14aa04da1440997878f50ad12c51f
            value: "config_sentence_transformers.json: 100%"
        6fac5c759c1c4d4ea305dada6061a2df:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: FloatProgressModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: FloatProgressModel
            _view_module: \@jupyter-widgets/controls
            _view_module_version: 1.5.0
            _view_name: ProgressView
            bar_style: success
            layout: IPY_MODEL_d5e829672e094926b98339ffd26a7977
            max: 437971872
            min: 0
            orientation: horizontal
            style: IPY_MODEL_20e8779132df48889711147cbb69dc6a
            value: 437971872
        74765d14545545b7b77144fe972d4d76:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: DescriptionStyleModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: DescriptionStyleModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: StyleView
        748a4c2bdf754c4c8abe01588ccf0f47:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: FloatProgressModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: FloatProgressModel
            _view_module: \@jupyter-widgets/controls
            _view_module_version: 1.5.0
            _view_name: ProgressView
            bar_style: success
            layout: IPY_MODEL_c8eb5e497e514872992f34444c30e14e
            max: 190
            min: 0
            orientation: horizontal
            style: IPY_MODEL_dd9ae5d407874734a7b0562c67873c03
            value: 190
        78738160c37e4243b35230903a786781:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: DescriptionStyleModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: DescriptionStyleModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: StyleView
        78cb42d4be8f40c5a4c30589ad088e43:
          model_module: \@jupyter-widgets/base
          model_module_version: 1.2.0
          model_name: LayoutModel
          state:
            _model_module: \@jupyter-widgets/base
            _model_module_version: 1.2.0
            _model_name: LayoutModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: LayoutView
        79b216552c9846db93cd80fefb9da055:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: HTMLModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: HTMLModel
            _view_module: \@jupyter-widgets/controls
            _view_module_version: 1.5.0
            _view_name: HTMLView
            layout: IPY_MODEL_78cb42d4be8f40c5a4c30589ad088e43
            placeholder: ​
            style: IPY_MODEL_2ff8d0f6dc474cb89622c6112fc038e5
            value: " 10.6k/10.6k \\[00:00&lt;00:00, 944kB/s\\]"
        7d25197401a343be8648c6d43b1c3dc0:
          model_module: \@jupyter-widgets/base
          model_module_version: 1.2.0
          model_name: LayoutModel
          state:
            _model_module: \@jupyter-widgets/base
            _model_module_version: 1.2.0
            _model_name: LayoutModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: LayoutView
        7f43ec74ad774eb2b55333f24da33e7d:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: FloatProgressModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: FloatProgressModel
            _view_module: \@jupyter-widgets/controls
            _view_module_version: 1.5.0
            _view_name: ProgressView
            bar_style: success
            layout: IPY_MODEL_f26f131368e242579aa9b1f24b2c9a57
            max: 571
            min: 0
            orientation: horizontal
            style: IPY_MODEL_458066ab2f9e49cfabbd798ac8b848fa
            value: 571
        84812e669af44679961d5987cffb46b0:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: DescriptionStyleModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: DescriptionStyleModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: StyleView
        850c3b25749d4929ae5a3c28eb50607a:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: ProgressStyleModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: ProgressStyleModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: StyleView
        850f2aae42f144aeac9488e45e50ef2c:
          model_module: \@jupyter-widgets/base
          model_module_version: 1.2.0
          model_name: LayoutModel
          state:
            _model_module: \@jupyter-widgets/base
            _model_module_version: 1.2.0
            _model_name: LayoutModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: LayoutView
        8b626b26601f4aa6a13816419faf4377:
          model_module: \@jupyter-widgets/base
          model_module_version: 1.2.0
          model_name: LayoutModel
          state:
            _model_module: \@jupyter-widgets/base
            _model_module_version: 1.2.0
            _model_name: LayoutModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: LayoutView
        8bf033c33e474b19b9c564fa9100c183:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: HTMLModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: HTMLModel
            _view_module: \@jupyter-widgets/controls
            _view_module_version: 1.5.0
            _view_name: HTMLView
            layout: IPY_MODEL_0a883eb65e0140bb9947ead458475cc2
            placeholder: ​
            style: IPY_MODEL_c10bc03b540b48fba66cd736623d2bdf
            value: "README.md: 100%"
        8e8b1397889346499d2412b9d4355393:
          model_module: \@jupyter-widgets/base
          model_module_version: 1.2.0
          model_name: LayoutModel
          state:
            _model_module: \@jupyter-widgets/base
            _model_module_version: 1.2.0
            _model_name: LayoutModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: LayoutView
        9030bb21c98e4afe80d66555f075ba1f:
          model_module: \@jupyter-widgets/base
          model_module_version: 1.2.0
          model_name: LayoutModel
          state:
            _model_module: \@jupyter-widgets/base
            _model_module_version: 1.2.0
            _model_name: LayoutModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: LayoutView
        930fb09dde6c45b39fc13430e1eba2e1:
          model_module: \@jupyter-widgets/base
          model_module_version: 1.2.0
          model_name: LayoutModel
          state:
            _model_module: \@jupyter-widgets/base
            _model_module_version: 1.2.0
            _model_name: LayoutModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: LayoutView
        962c02b905e94482a0df21d2446d7b12:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: DescriptionStyleModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: DescriptionStyleModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: StyleView
        97429376df3d435db165db40ffa1f370:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: FloatProgressModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: FloatProgressModel
            _view_module: \@jupyter-widgets/controls
            _view_module_version: 1.5.0
            _view_name: ProgressView
            bar_style: success
            layout: IPY_MODEL_b895c24ccc5a40d9bb8f0bf9f445b8ca
            max: 4
            min: 0
            orientation: horizontal
            style: IPY_MODEL_4d16efaac068411b808af9acbe88047b
            value: 4
        97bc56549f27455f956492d5c7acab94:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: DescriptionStyleModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: DescriptionStyleModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: StyleView
        9a3df2bca94e4a44a30008e82c2df4e5:
          model_module: \@jupyter-widgets/base
          model_module_version: 1.2.0
          model_name: LayoutModel
          state:
            _model_module: \@jupyter-widgets/base
            _model_module_version: 1.2.0
            _model_name: LayoutModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: LayoutView
        9c30564b37334101b999abc469568315:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: HBoxModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: HBoxModel
            _view_module: \@jupyter-widgets/controls
            _view_module_version: 1.5.0
            _view_name: HBoxView
            children:
            - IPY_MODEL_69174407dcf746d4b46592e7af96459f
            - IPY_MODEL_01f84f42f6f24003b5bafa1e295066f7
            - IPY_MODEL_ba46b2475c504c4789904ec41e8c4fb3
            layout: IPY_MODEL_9d4d23c3dc8c47efa95b26acd4242c03
        9cb6fd5aa3fe4b66b61913f1fb50a7c6:
          model_module: \@jupyter-widgets/base
          model_module_version: 1.2.0
          model_name: LayoutModel
          state:
            _model_module: \@jupyter-widgets/base
            _model_module_version: 1.2.0
            _model_name: LayoutModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: LayoutView
        9d4d23c3dc8c47efa95b26acd4242c03:
          model_module: \@jupyter-widgets/base
          model_module_version: 1.2.0
          model_name: LayoutModel
          state:
            _model_module: \@jupyter-widgets/base
            _model_module_version: 1.2.0
            _model_name: LayoutModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: LayoutView
        9fb141280a6341d2b45242b84e7acc52:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: DescriptionStyleModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: DescriptionStyleModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: StyleView
        9fe6b28a56d543ddb32f7220d940bb17:
          model_module: \@jupyter-widgets/base
          model_module_version: 1.2.0
          model_name: LayoutModel
          state:
            _model_module: \@jupyter-widgets/base
            _model_module_version: 1.2.0
            _model_name: LayoutModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: LayoutView
        a2cba0d47e9b4ec79a890a4ec773dd5e:
          model_module: \@jupyter-widgets/base
          model_module_version: 1.2.0
          model_name: LayoutModel
          state:
            _model_module: \@jupyter-widgets/base
            _model_module_version: 1.2.0
            _model_name: LayoutModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: LayoutView
        a32b643fa8da46439e7cf1113e3731f7:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: FloatProgressModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: FloatProgressModel
            _view_module: \@jupyter-widgets/controls
            _view_module_version: 1.5.0
            _view_name: ProgressView
            bar_style: success
            layout: IPY_MODEL_d22c120c0c2449e98a637b0ef100b4fc
            max: 363
            min: 0
            orientation: horizontal
            style: IPY_MODEL_0d5bbf9f5a344194a645cf03ccec4b36
            value: 363
        a349845bf40c44b7a09dd337c8cf3e9c:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: HTMLModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: HTMLModel
            _view_module: \@jupyter-widgets/controls
            _view_module_version: 1.5.0
            _view_name: HTMLView
            layout: IPY_MODEL_b35c0fa2d91144e88a0fd0ef0888265f
            placeholder: ​
            style: IPY_MODEL_1a8735baeabf4b3c91d141f71d129f9b
            value: "model.safetensors: 100%"
        a943a1b93d56405fa5f91286207b147f:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: HTMLModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: HTMLModel
            _view_module: \@jupyter-widgets/controls
            _view_module_version: 1.5.0
            _view_name: HTMLView
            layout: IPY_MODEL_2470a2c5bb214efaadefbf538f6931e8
            placeholder: ​
            style: IPY_MODEL_547b7e8f86cd4712b6bc9dbaefd378e3
            value: " 438M/438M \\[00:02&lt;00:00, 206MB/s\\]"
        aa49cb3023934f4aa526d134c2e0faac:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: DescriptionStyleModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: DescriptionStyleModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: StyleView
        af090bf079ee427ea6aaa5b89c3d93c3:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: HTMLModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: HTMLModel
            _view_module: \@jupyter-widgets/controls
            _view_module_version: 1.5.0
            _view_name: HTMLView
            layout: IPY_MODEL_3d44868eb4984b058a2f3c5d576c2e00
            placeholder: ​
            style: IPY_MODEL_1ad175ff12104aaab9e52297472c0c17
            value: "modules.json: 100%"
        afa9068869bd4119a1556ccace36d211:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: HTMLModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: HTMLModel
            _view_module: \@jupyter-widgets/controls
            _view_module_version: 1.5.0
            _view_name: HTMLView
            layout: IPY_MODEL_5470e863f8724e3ca685cb563ac6e58d
            placeholder: ​
            style: IPY_MODEL_f5c2d36fbade4840af41333b6079ba8a
            value: "sentence_bert_config.json: 100%"
        afd317cd9bb047a089dcd927be11a9d0:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: HTMLModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: HTMLModel
            _view_module: \@jupyter-widgets/controls
            _view_module_version: 1.5.0
            _view_name: HTMLView
            layout: IPY_MODEL_561ab234f50640c29c13d28cd3b93d00
            placeholder: ​
            style: IPY_MODEL_c6d60b74316a44edb849c08bc5fcb47b
            value: " 571/571 \\[00:00&lt;00:00, 51.9kB/s\\]"
        b2249fb6c1b94ee0b7debdef118c3320:
          model_module: \@jupyter-widgets/base
          model_module_version: 1.2.0
          model_name: LayoutModel
          state:
            _model_module: \@jupyter-widgets/base
            _model_module_version: 1.2.0
            _model_name: LayoutModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: LayoutView
        b35c0fa2d91144e88a0fd0ef0888265f:
          model_module: \@jupyter-widgets/base
          model_module_version: 1.2.0
          model_name: LayoutModel
          state:
            _model_module: \@jupyter-widgets/base
            _model_module_version: 1.2.0
            _model_name: LayoutModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: LayoutView
        b82fbf0300aa411ab350cb471a1a544b:
          model_module: \@jupyter-widgets/base
          model_module_version: 1.2.0
          model_name: LayoutModel
          state:
            _model_module: \@jupyter-widgets/base
            _model_module_version: 1.2.0
            _model_name: LayoutModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: LayoutView
        b857a42632c94656885cdd67b9390e9f:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: FloatProgressModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: FloatProgressModel
            _view_module: \@jupyter-widgets/controls
            _view_module_version: 1.5.0
            _view_name: ProgressView
            bar_style: success
            layout: IPY_MODEL_fd8efd5f4cdc4c22b16963c43b02c7b0
            max: 10621
            min: 0
            orientation: horizontal
            style: IPY_MODEL_f1bad9fb897941f2aa91e419159a3aad
            value: 10621
        b895c24ccc5a40d9bb8f0bf9f445b8ca:
          model_module: \@jupyter-widgets/base
          model_module_version: 1.2.0
          model_name: LayoutModel
          state:
            _model_module: \@jupyter-widgets/base
            _model_module_version: 1.2.0
            _model_name: LayoutModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: LayoutView
        b9f14aa04da1440997878f50ad12c51f:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: DescriptionStyleModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: DescriptionStyleModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: StyleView
        ba123193ccc845d7840a5586fcf1c1e7:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: HTMLModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: HTMLModel
            _view_module: \@jupyter-widgets/controls
            _view_module_version: 1.5.0
            _view_name: HTMLView
            layout: IPY_MODEL_8b626b26601f4aa6a13816419faf4377
            placeholder: ​
            style: IPY_MODEL_78738160c37e4243b35230903a786781
            value: "Map: 100%"
        ba46b2475c504c4789904ec41e8c4fb3:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: HTMLModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: HTMLModel
            _view_module: \@jupyter-widgets/controls
            _view_module_version: 1.5.0
            _view_name: HTMLView
            layout: IPY_MODEL_667a5200c3be487288e3024ff3bb6178
            placeholder: ​
            style: IPY_MODEL_74765d14545545b7b77144fe972d4d76
            value: " 116/116 \\[00:00&lt;00:00, 9.42kB/s\\]"
        bd4e883597604a069e23daa8d03f9c07:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: FloatProgressModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: FloatProgressModel
            _view_module: \@jupyter-widgets/controls
            _view_module_version: 1.5.0
            _view_name: ProgressView
            bar_style: success
            layout: IPY_MODEL_c458dd3eee754b0e9b339bbdefc7c71c
            max: 166
            min: 0
            orientation: horizontal
            style: IPY_MODEL_0126dc7b2b994778a8b555ee6c848e46
            value: 166
        bdea551b89254ea39bd88dc271974b28:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: HTMLModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: HTMLModel
            _view_module: \@jupyter-widgets/controls
            _view_module_version: 1.5.0
            _view_name: HTMLView
            layout: IPY_MODEL_16e366561b294c6788d8f4525d1a0230
            placeholder: ​
            style: IPY_MODEL_10942534bda04ebbb98019eb03af63c1
            value: "1_Pooling/config.json: 100%"
        bef9528fb3ee4fd184884f9975e03809:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: DescriptionStyleModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: DescriptionStyleModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: StyleView
        c05e6cda549e4fc498f84f1badc71e18:
          model_module: \@jupyter-widgets/base
          model_module_version: 1.2.0
          model_name: LayoutModel
          state:
            _model_module: \@jupyter-widgets/base
            _model_module_version: 1.2.0
            _model_name: LayoutModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: LayoutView
        c0e50b36799c40aab9968626fae15ac5:
          model_module: \@jupyter-widgets/base
          model_module_version: 1.2.0
          model_name: LayoutModel
          state:
            _model_module: \@jupyter-widgets/base
            _model_module_version: 1.2.0
            _model_name: LayoutModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: LayoutView
        c10bc03b540b48fba66cd736623d2bdf:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: DescriptionStyleModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: DescriptionStyleModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: StyleView
        c2b21e996af549aa8dc87274d9793071:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: ProgressStyleModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: ProgressStyleModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: StyleView
        c458dd3eee754b0e9b339bbdefc7c71c:
          model_module: \@jupyter-widgets/base
          model_module_version: 1.2.0
          model_name: LayoutModel
          state:
            _model_module: \@jupyter-widgets/base
            _model_module_version: 1.2.0
            _model_name: LayoutModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: LayoutView
        c6b24d15f54a42ee9ece06837bdd434b:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: DescriptionStyleModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: DescriptionStyleModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: StyleView
        c6cc0f22281e4d48aa5dbcef26cb02be:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: HTMLModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: HTMLModel
            _view_module: \@jupyter-widgets/controls
            _view_module_version: 1.5.0
            _view_name: HTMLView
            layout: IPY_MODEL_7d25197401a343be8648c6d43b1c3dc0
            placeholder: ​
            style: IPY_MODEL_4fa9b811cec64f67b30d1f990d753b47
            value: "tokenizer_config.json: 100%"
        c6d481df4e234d9d9f7e6a5d806e3226:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: HTMLModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: HTMLModel
            _view_module: \@jupyter-widgets/controls
            _view_module_version: 1.5.0
            _view_name: HTMLView
            layout: IPY_MODEL_b2249fb6c1b94ee0b7debdef118c3320
            placeholder: ​
            style: IPY_MODEL_962c02b905e94482a0df21d2446d7b12
            value: " 53.0/53.0 \\[00:00&lt;00:00, 4.64kB/s\\]"
        c6d60b74316a44edb849c08bc5fcb47b:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: DescriptionStyleModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: DescriptionStyleModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: StyleView
        c7d5482753cd4adcb16dfe19fcd38c5a:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: DescriptionStyleModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: DescriptionStyleModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: StyleView
        c86d5b9e9b2945bda487a4d17a04fca5:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: HTMLModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: HTMLModel
            _view_module: \@jupyter-widgets/controls
            _view_module_version: 1.5.0
            _view_name: HTMLView
            layout: IPY_MODEL_c0e50b36799c40aab9968626fae15ac5
            placeholder: ​
            style: IPY_MODEL_bef9528fb3ee4fd184884f9975e03809
            value: "vocab.txt: 100%"
        c8eb5e497e514872992f34444c30e14e:
          model_module: \@jupyter-widgets/base
          model_module_version: 1.2.0
          model_name: LayoutModel
          state:
            _model_module: \@jupyter-widgets/base
            _model_module_version: 1.2.0
            _model_name: LayoutModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: LayoutView
        cae3ba2c821c43d4a7f79425fa64b978:
          model_module: \@jupyter-widgets/base
          model_module_version: 1.2.0
          model_name: LayoutModel
          state:
            _model_module: \@jupyter-widgets/base
            _model_module_version: 1.2.0
            _model_name: LayoutModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: LayoutView
        cfe17233609c4ae7940135b58ebc1c50:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: FloatProgressModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: FloatProgressModel
            _view_module: \@jupyter-widgets/controls
            _view_module_version: 1.5.0
            _view_name: ProgressView
            bar_style: success
            layout: IPY_MODEL_d8a8698012734c29b5a0f2eb9edd8bc2
            max: 466021
            min: 0
            orientation: horizontal
            style: IPY_MODEL_0581b220947045f7b8fbb8f15a507c2f
            value: 466021
        cfed0dbbb8f3464da24b82b0f6f08a00:
          model_module: \@jupyter-widgets/base
          model_module_version: 1.2.0
          model_name: LayoutModel
          state:
            _model_module: \@jupyter-widgets/base
            _model_module_version: 1.2.0
            _model_name: LayoutModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: LayoutView
        d1402121b8324664b523f4fb348db59a:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: FloatProgressModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: FloatProgressModel
            _view_module: \@jupyter-widgets/controls
            _view_module_version: 1.5.0
            _view_name: ProgressView
            bar_style: success
            layout: IPY_MODEL_850f2aae42f144aeac9488e45e50ef2c
            max: 239
            min: 0
            orientation: horizontal
            style: IPY_MODEL_c2b21e996af549aa8dc87274d9793071
            value: 239
        d22c120c0c2449e98a637b0ef100b4fc:
          model_module: \@jupyter-widgets/base
          model_module_version: 1.2.0
          model_name: LayoutModel
          state:
            _model_module: \@jupyter-widgets/base
            _model_module_version: 1.2.0
            _model_name: LayoutModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: LayoutView
        d5e829672e094926b98339ffd26a7977:
          model_module: \@jupyter-widgets/base
          model_module_version: 1.2.0
          model_name: LayoutModel
          state:
            _model_module: \@jupyter-widgets/base
            _model_module_version: 1.2.0
            _model_name: LayoutModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: LayoutView
        d6466824a236418b9b281a800e7c4e7e:
          model_module: \@jupyter-widgets/base
          model_module_version: 1.2.0
          model_name: LayoutModel
          state:
            _model_module: \@jupyter-widgets/base
            _model_module_version: 1.2.0
            _model_name: LayoutModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: LayoutView
        d6b5eaf2ec854806b173e31804119425:
          model_module: \@jupyter-widgets/base
          model_module_version: 1.2.0
          model_name: LayoutModel
          state:
            _model_module: \@jupyter-widgets/base
            _model_module_version: 1.2.0
            _model_name: LayoutModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: LayoutView
        d6c85282610c43a7b26dcf9ecb7be155:
          model_module: \@jupyter-widgets/base
          model_module_version: 1.2.0
          model_name: LayoutModel
          state:
            _model_module: \@jupyter-widgets/base
            _model_module_version: 1.2.0
            _model_name: LayoutModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: LayoutView
        d7a1067d89d44a0c92983c6fd21cac4d:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: HBoxModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: HBoxModel
            _view_module: \@jupyter-widgets/controls
            _view_module_version: 1.5.0
            _view_name: HBoxView
            children:
            - IPY_MODEL_a349845bf40c44b7a09dd337c8cf3e9c
            - IPY_MODEL_6fac5c759c1c4d4ea305dada6061a2df
            - IPY_MODEL_a943a1b93d56405fa5f91286207b147f
            layout: IPY_MODEL_d6c85282610c43a7b26dcf9ecb7be155
        d80ac356109448ec96ec284307511ceb:
          model_module: \@jupyter-widgets/base
          model_module_version: 1.2.0
          model_name: LayoutModel
          state:
            _model_module: \@jupyter-widgets/base
            _model_module_version: 1.2.0
            _model_name: LayoutModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: LayoutView
        d8a8698012734c29b5a0f2eb9edd8bc2:
          model_module: \@jupyter-widgets/base
          model_module_version: 1.2.0
          model_name: LayoutModel
          state:
            _model_module: \@jupyter-widgets/base
            _model_module_version: 1.2.0
            _model_name: LayoutModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: LayoutView
        db1c4df02b97484e918ee9740a2c2411:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: FloatProgressModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: FloatProgressModel
            _view_module: \@jupyter-widgets/controls
            _view_module_version: 1.5.0
            _view_name: ProgressView
            bar_style: success
            layout: IPY_MODEL_1107cace99b549adaa2908d26090595a
            max: 349
            min: 0
            orientation: horizontal
            style: IPY_MODEL_1bb98e28459c48709ea484d240c6d94f
            value: 349
        dcace745abaa4f42bb9be50072ac9408:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: FloatProgressModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: FloatProgressModel
            _view_module: \@jupyter-widgets/controls
            _view_module_version: 1.5.0
            _view_name: ProgressView
            bar_style: success
            layout: IPY_MODEL_4c9cb7f3481f4f4bb5e956b91f152ca9
            max: 231536
            min: 0
            orientation: horizontal
            style: IPY_MODEL_850c3b25749d4929ae5a3c28eb50607a
            value: 231536
        dd153e6e7934471683e693804a65518a:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: HTMLModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: HTMLModel
            _view_module: \@jupyter-widgets/controls
            _view_module_version: 1.5.0
            _view_name: HTMLView
            layout: IPY_MODEL_9cb6fd5aa3fe4b66b61913f1fb50a7c6
            placeholder: ​
            style: IPY_MODEL_aa49cb3023934f4aa526d134c2e0faac
            value: "special_tokens_map.json: 100%"
        dd9ae5d407874734a7b0562c67873c03:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: ProgressStyleModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: ProgressStyleModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: StyleView
        de1430b4e3244de6982d7874755aad7c:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: HBoxModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: HBoxModel
            _view_module: \@jupyter-widgets/controls
            _view_module_version: 1.5.0
            _view_name: HBoxView
            children:
            - IPY_MODEL_ba123193ccc845d7840a5586fcf1c1e7
            - IPY_MODEL_bd4e883597604a069e23daa8d03f9c07
            - IPY_MODEL_562ef17eefa14e3387cec6f6a412cf70
            layout: IPY_MODEL_c05e6cda549e4fc498f84f1badc71e18
        e15afb01fc46468289d0e5280f392096:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: HTMLModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: HTMLModel
            _view_module: \@jupyter-widgets/controls
            _view_module_version: 1.5.0
            _view_name: HTMLView
            layout: IPY_MODEL_a2cba0d47e9b4ec79a890a4ec773dd5e
            placeholder: ​
            style: IPY_MODEL_184628c80d7c45fea4cd95fc1910f70b
            value: "Loading checkpoint shards: 100%"
        f18eaf0578cf4b21932b7985124c0e30:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: HTMLModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: HTMLModel
            _view_module: \@jupyter-widgets/controls
            _view_module_version: 1.5.0
            _view_name: HTMLView
            layout: IPY_MODEL_fbea57d10f004eee9c39010c4a4291de
            placeholder: ​
            style: IPY_MODEL_c6b24d15f54a42ee9ece06837bdd434b
            value: " 466k/466k \\[00:00&lt;00:00, 24.4MB/s\\]"
        f1bad9fb897941f2aa91e419159a3aad:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: ProgressStyleModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: ProgressStyleModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: StyleView
        f26f131368e242579aa9b1f24b2c9a57:
          model_module: \@jupyter-widgets/base
          model_module_version: 1.2.0
          model_name: LayoutModel
          state:
            _model_module: \@jupyter-widgets/base
            _model_module_version: 1.2.0
            _model_name: LayoutModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: LayoutView
        f2b438bff2ee4379a591136edddbb071:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: HBoxModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: HBoxModel
            _view_module: \@jupyter-widgets/controls
            _view_module_version: 1.5.0
            _view_name: HBoxView
            children:
            - IPY_MODEL_bdea551b89254ea39bd88dc271974b28
            - IPY_MODEL_748a4c2bdf754c4c8abe01588ccf0f47
            - IPY_MODEL_47b9538d76594755a281f60ddf4e5a92
            layout: IPY_MODEL_9a3df2bca94e4a44a30008e82c2df4e5
        f34f3fc4bb78413682c1cdc2b6a476a0:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: HTMLModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: HTMLModel
            _view_module: \@jupyter-widgets/controls
            _view_module_version: 1.5.0
            _view_name: HTMLView
            layout: IPY_MODEL_cfed0dbbb8f3464da24b82b0f6f08a00
            placeholder: ​
            style: IPY_MODEL_3477df3357df42439acc9c1bc2fc1252
            value: " 239/239 \\[00:00&lt;00:00, 22.2kB/s\\]"
        f4accf29605e482b97fbbe8736ba2ef1:
          model_module: \@jupyter-widgets/base
          model_module_version: 1.2.0
          model_name: LayoutModel
          state:
            _model_module: \@jupyter-widgets/base
            _model_module_version: 1.2.0
            _model_name: LayoutModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: LayoutView
        f5c2d36fbade4840af41333b6079ba8a:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: DescriptionStyleModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: DescriptionStyleModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: StyleView
        f9fbead6425a45f5989835efe1e44f55:
          model_module: \@jupyter-widgets/base
          model_module_version: 1.2.0
          model_name: LayoutModel
          state:
            _model_module: \@jupyter-widgets/base
            _model_module_version: 1.2.0
            _model_name: LayoutModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: LayoutView
        fbea57d10f004eee9c39010c4a4291de:
          model_module: \@jupyter-widgets/base
          model_module_version: 1.2.0
          model_name: LayoutModel
          state:
            _model_module: \@jupyter-widgets/base
            _model_module_version: 1.2.0
            _model_name: LayoutModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: LayoutView
        fd8efd5f4cdc4c22b16963c43b02c7b0:
          model_module: \@jupyter-widgets/base
          model_module_version: 1.2.0
          model_name: LayoutModel
          state:
            _model_module: \@jupyter-widgets/base
            _model_module_version: 1.2.0
            _model_name: LayoutModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: LayoutView
        fe3a4d331904408e93ba9de7c3ef13a2:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: ProgressStyleModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: ProgressStyleModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: StyleView
        ff15a60f12954802ba5a29f0184ce51f:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: HBoxModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: HBoxModel
            _view_module: \@jupyter-widgets/controls
            _view_module_version: 1.5.0
            _view_name: HBoxView
            children:
            - IPY_MODEL_e15afb01fc46468289d0e5280f392096
            - IPY_MODEL_97429376df3d435db165db40ffa1f370
            - IPY_MODEL_1068b4bcb8b744b0abd00e2f3edb3d25
            layout: IPY_MODEL_f4accf29605e482b97fbbe8736ba2ef1
        ffe13121fd6e4b98a7e2b979e12d4f34:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: DescriptionStyleModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: DescriptionStyleModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: StyleView
      version_major: 2
      version_minor: 0
---

::: {#32fb1d22 .cell .markdown}
# \"Datascience concpets tutor using gemma\"

> \"Awesome summary\"

-   toc:true- branch: master
-   badges: true
-   comments: true
-   author: Hamel Husain & Jeremy Howard
-   categories: \[fastpages, jupyter\]
:::

::: {#3d49a34b .cell .markdown _cell_guid="b1076dfc-b9ad-4769-8c92-a6c4dae69d19" _uuid="8f2839f25d086af736a60e9eeb907d3b93b6e0e5" execution="{\"iopub.execute_input\":\"2024-04-14T18:22:57.515377Z\",\"iopub.status.busy\":\"2024-04-14T18:22:57.515112Z\",\"iopub.status.idle\":\"2024-04-14T18:22:58.300976Z\",\"shell.execute_reply\":\"2024-04-14T18:22:58.299982Z\",\"shell.execute_reply.started\":\"2024-04-14T18:22:57.515354Z\"}" papermill="{\"duration\":1.3789e-2,\"end_time\":\"2024-04-14T21:37:21.625813\",\"exception\":false,\"start_time\":\"2024-04-14T21:37:21.612024\",\"status\":\"completed\"}" tags="[]"}
# **1. Introduction** {#1-introduction}
:::

::: {#09c51c0c .cell .markdown papermill="{\"duration\":1.1602e-2,\"end_time\":\"2024-04-14T21:37:21.649963\",\"exception\":false,\"start_time\":\"2024-04-14T21:37:21.638361\",\"status\":\"completed\"}" tags="[]"}
```{=html}
<p style="font-size: 24px;text-align:center;"><b>What is Google Gemma Model?</b></p>
```
```{=html}
<div align="center"><img style="height:40%; width:40%" src="https://storage.googleapis.com/gweb-uniblog-publish-prod/images/gemma-header.width-1200.format-webp.webp"/></div>
```
```{=html}
<p style="text-align:center;font-size:18px;">
```
`<b>`{=html}Image
`</b>`{=html}`<a href="https://blog.google/technology/developers/gemma-open-models/">`{=html}`<b>`{=html}
src`</b>`{=html}`</a>`{=html}

```{=html}
<p style="font-size: 18px;"><strong>Gemma Model</strong> is a family of open-source large language models created by Google AI. These models are known for being lightweight and powerful, achieving good performance on various tasks for their size. Here's a breakdown of what Gemma models are:</p>
```
```{=html}
<ul style="font-size: 18px;">
    <li><strong>State-of-the-art:</strong> Compared to other models like Llama 2 and Mistral 7B, Gemma models perform competitively on benchmarks that measure knowledge, problem-solving abilities, and common sense reasoning.</li>
    <li><strong>Lightweight:</strong> Gemma models are designed to be smaller and require less computing power than other large language models. This makes them more accessible for people who don't have access to powerful machines.</li>
    <li><strong>Open-source:</strong> Anyone can access and use Gemma models, and researchers can even fine-tune them for specific tasks.</li>
    <li><strong>Flexible:</strong> Gemma models work with various tools and frameworks, including TensorFlow, JAX, PyTorch, and Hugging Face Transformers. They can also run on different devices, from laptops to mobile phones.</li>
</ul>
```
```{=html}
<p style="font-size: 18px;">Overall, Gemma models are a good option for developers and researchers who are looking for a powerful and versatile large language model that is easy to use and modify.</p>
```
:::

::: {#8f2a4315 .cell .markdown execution="{\"iopub.execute_input\":\"2024-04-14T21:16:13.550726Z\",\"iopub.status.busy\":\"2024-04-14T21:16:13.549971Z\",\"iopub.status.idle\":\"2024-04-14T21:16:13.557606Z\",\"shell.execute_reply\":\"2024-04-14T21:16:13.556526Z\",\"shell.execute_reply.started\":\"2024-04-14T21:16:13.550692Z\"}" papermill="{\"duration\":1.1192e-2,\"end_time\":\"2024-04-14T21:37:21.672526\",\"exception\":false,\"start_time\":\"2024-04-14T21:37:21.661334\",\"status\":\"completed\"}" tags="[]"}
## In this, I tried to make a data science assistant using Gemma. I utilized concepts like fine-tuning and RAG (Retrieval Augmented Generation). I hope you enjoy this notebook, which contains step-by-step instructions on how to fine-tune and use RAG. {#in-this-i-tried-to-make-a-data-science-assistant-using-gemma-i-utilized-concepts-like-fine-tuning-and-rag-retrieval-augmented-generation-i-hope-you-enjoy-this-notebook-which-contains-step-by-step-instructions-on-how-to-fine-tune-and-use-rag}

## Contents:

1.  Introduction
2.  Training the Model
3.  Fine-Tune Model
4.  Retrieval Augmented Generation (RAG)
:::

::: {#c26009df .cell .markdown papermill="{\"duration\":1.1083e-2,\"end_time\":\"2024-04-14T21:37:21.694867\",\"exception\":false,\"start_time\":\"2024-04-14T21:37:21.683784\",\"status\":\"completed\"}" tags="[]"}
```{=html}
<p style="font-size: 24px;text-align:center;"><b>The difference between Pretrained and Instruction tuned LLMs</b></p>
```
A pre-trained model is starting points for creating a model that can
follow a specific instruction. However, the only difference is that a
pretrained model is just trained on chunks of data but a instruction
tuned model is fine tuned on instruction response , so it learns to
generate response to instructions :

### **Pre-trained Model:**

-   **Training:** A pre-trained model is trained on a massive dataset of
    unlabeled text or data (like text or images) that covers a broad
    range of topics. This initial training helps the model develop a
    general understanding of language or the world.
-   **Focus:** Think of it as learning the building blocks or
    foundational skills. It doesn\'t learn a specific task but develops
    a strong base for various tasks related to the type of data it\'s
    trained on.
-   **Benefits:** Pre-trained models are very efficient. They leverage
    the vast amount of data processed during pre-training, so you don\'t
    need to start from scratch when tackling a specific task.
-   **Drawback:** While versatile, they might not be perfect for a
    specific domain or task since the focus wasn\'t on that specific
    area.

### **Instruction-Tuned Model:**

-   **Training:** An instruction-tuned model starts with a pre-trained
    model as a base. Then, it\'s further trained on a smaller dataset
    specifically designed for the desired task. This dataset often
    includes labeled examples with instructions or prompts about what
    the model should learn.\
-   **Focus:** This additional training refines the model\'s
    understanding to the specific task. It\'s like taking those building
    blocks and using them to construct something specific.
-   **Benefits:** Instruction-tuned models can achieve higher accuracy
    on a specific task compared to a pre-trained model used directly.
-   **Drawback:** Tuning requires a task-specific dataset, and the
    success depends on the quality and size of that data.
:::

::: {#ceeb0540 .cell .markdown papermill="{\"duration\":1.0902e-2,\"end_time\":\"2024-04-14T21:37:21.717554\",\"exception\":false,\"start_time\":\"2024-04-14T21:37:21.706652\",\"status\":\"completed\"}" tags="[]"}
# **2. Training the model** {#2-training-the-model}

## **Install dependencies**

### Install transformers,langchain, and other dependencies. {#install-transformerslangchain-and-other-dependencies}
:::

::: {#f620e958 .cell .code execution_count="1" execution="{\"iopub.execute_input\":\"2024-04-14T21:37:21.743093Z\",\"iopub.status.busy\":\"2024-04-14T21:37:21.742681Z\",\"iopub.status.idle\":\"2024-04-14T21:40:06.389387Z\",\"shell.execute_reply\":\"2024-04-14T21:40:06.388103Z\"}" papermill="{\"duration\":164.661924,\"end_time\":\"2024-04-14T21:40:06.392000\",\"exception\":false,\"start_time\":\"2024-04-14T21:37:21.730076\",\"status\":\"completed\"}" tags="[]"}
``` python
%%capture
%pip install -q bitsandbytes
%pip install -q transformers
%pip install -q peft
%pip install -q accelerate
%pip install -q trl
%pip install -q torch
%pip install -q langchain pypdf sentence-transformers
%pip install langchain
%pip install chromadb -q
%pip install sentence-transformers -q
```
:::

::: {#3e0604de .cell .code execution_count="2" execution="{\"iopub.execute_input\":\"2024-04-14T21:40:06.414918Z\",\"iopub.status.busy\":\"2024-04-14T21:40:06.414309Z\",\"iopub.status.idle\":\"2024-04-14T21:40:26.137183Z\",\"shell.execute_reply\":\"2024-04-14T21:40:26.136237Z\"}" papermill="{\"duration\":19.736707,\"end_time\":\"2024-04-14T21:40:26.139490\",\"exception\":false,\"start_time\":\"2024-04-14T21:40:06.402783\",\"status\":\"completed\"}" tags="[]"}
``` python
%%capture
import os, torch
import spacy
import pandas as pd
from transformers import AutoModelForCausalLM, AutoTokenizer, BitsAndBytesConfig, AutoConfig, TrainingArguments, pipeline
from peft import LoraConfig, PeftModel, prepare_model_for_kbit_training, get_peft_model
from trl import SFTTrainer
from datasets import Dataset
from IPython.display import Markdown, display
from langchain.text_splitter import RecursiveCharacterTextSplitter
from langchain.embeddings import HuggingFaceEmbeddings
from langchain.chains import RetrievalQA
from langchain.llms import HuggingFacePipeline
from langchain_community.embeddings.sentence_transformer import SentenceTransformerEmbeddings
from langchain_community.vectorstores import Chroma
from langchain_text_splitters import RecursiveCharacterTextSplitter
from langchain_community.document_loaders.csv_loader import CSVLoader
from langchain_community.llms import HuggingFaceEndpoint

from langchain_core.prompts import PromptTemplate
import re
```

::: {.output .stream .stderr}
    2024-04-14 21:40:17.182886: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:9261] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
    2024-04-14 21:40:17.182984: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:607] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
    2024-04-14 21:40:17.274756: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1515] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
:::
:::

::: {#71fb037b .cell .markdown papermill="{\"duration\":9.998e-3,\"end_time\":\"2024-04-14T21:40:26.159971\",\"exception\":false,\"start_time\":\"2024-04-14T21:40:26.149973\",\"status\":\"completed\"}" tags="[]"}
## Configure a Large Language Model (LLM) for Inference with Quantization

**Model Path and Quantization Configuration:**

1.  **Model Path:** `model` stores the path to a pre-trained causal
    language model (likely a 2-billion parameter model) on Kaggle
    Datasets.

2.  **BitsAndBytesConfig:** `bnbConfig` defines quantization
    configuration:

    -   `load_in_4bit (bool, optional)`: Enable 4-bit quantization,
        reducing memory usage approximately fourfold.
    -   `bnb_4bit_quant_type (str, optional)`: Specify the 4-bit
        quantization type, set to `"nf4"`.
    -   `bnb_4bit_compute_dtype (torch.dtype, optional)`: Define
        computation data type during inference, set to `torch.bfloat16`.

**Loading Tokenizer and Model with Quantization:**

1.  **AutoTokenizer:** `AutoTokenizer.from_pretrained` loads the
    tokenizer associated with the pre-trained model at `model`,
    considering quantization information.

2.  **AutoModelForCausalLM:** `AutoModelForCausalLM.from_pretrained`
    loads the LLM model from `model`, with automatic device placement
    (`device_map="auto"`) and quantization configuration.

**Objective:**

This code aims to:

-   Load a pre-trained LLM from the specified path.
-   Enable 4-bit quantization for memory reduction and potentially
    faster inference.
:::

::: {#51a01f10 .cell .code execution_count="3" execution="{\"iopub.execute_input\":\"2024-04-14T21:40:26.181748Z\",\"iopub.status.busy\":\"2024-04-14T21:40:26.181233Z\",\"iopub.status.idle\":\"2024-04-14T21:42:36.529897Z\",\"shell.execute_reply\":\"2024-04-14T21:42:36.529027Z\"}" papermill="{\"duration\":130.36198,\"end_time\":\"2024-04-14T21:42:36.531922\",\"exception\":false,\"start_time\":\"2024-04-14T21:40:26.169942\",\"status\":\"completed\"}" tags="[]"}
``` python
model = "/kaggle/input/gemma/transformers/1.1-7b-it/1"

bnbConfig = BitsAndBytesConfig(
    load_in_4bit = True,
    bnb_4bit_quant_type="nf4",
    bnb_4bit_compute_dtype=torch.bfloat16,
)

tokenizer = AutoTokenizer.from_pretrained(model, quantization_config=bnbConfig, device_map="auto")

model = AutoModelForCausalLM.from_pretrained(
    model,
    device_map = "auto",
    quantization_config=bnbConfig
)
```

::: {.output .display_data}
``` json
{"model_id":"ff15a60f12954802ba5a29f0184ce51f","version_major":2,"version_minor":0}
```
:::
:::

::: {#359bf76e .cell .markdown papermill="{\"duration\":1.0341e-2,\"end_time\":\"2024-04-14T21:42:36.553074\",\"exception\":false,\"start_time\":\"2024-04-14T21:42:36.542733\",\"status\":\"completed\"}" tags="[]"}
# **3. Fine Tune Model** {#3-fine-tune-model}
:::

::: {#e50e8ab5 .cell .markdown papermill="{\"duration\":1.0034e-2,\"end_time\":\"2024-04-14T21:42:36.573470\",\"exception\":false,\"start_time\":\"2024-04-14T21:42:36.563436\",\"status\":\"completed\"}" tags="[]"}
## Text Data Cleaning Functions

### Function: `remove_emoji(string)`

-   **Purpose:** Removes emojis from a string using regex.
-   **Implementation:** Utilizes regex to replace emoji patterns with an
    empty string.

### Function: `data_cleaning(data)`

-   **Purpose:** Cleans text columns in a pandas DataFrame.
-   **Steps:**
    1.  **Column Retrieval:** Extracts column names.
    2.  **Text Cleaning:**
        -   Removes HTML tags, newline characters, and user tags.
        -   Applies `remove_emoji` function to remove emojis.
    3.  **Repeat Cleaning:** Applies cleaning steps to the second
        column.
-   **Returns:** Cleaned DataFrame.

### Note:

-   Functions use regex for efficient text manipulation.
-   `remove_emoji` function seamlessly handles emoji removal within
    `data_cleaning`.
-   Suitable for integration into NLP preprocessing pipelines.
:::

::: {#e2174953 .cell .code execution_count="4" execution="{\"iopub.execute_input\":\"2024-04-14T21:42:36.596422Z\",\"iopub.status.busy\":\"2024-04-14T21:42:36.596106Z\",\"iopub.status.idle\":\"2024-04-14T21:42:36.606575Z\",\"shell.execute_reply\":\"2024-04-14T21:42:36.605714Z\"}" papermill="{\"duration\":2.4842e-2,\"end_time\":\"2024-04-14T21:42:36.608471\",\"exception\":false,\"start_time\":\"2024-04-14T21:42:36.583629\",\"status\":\"completed\"}" tags="[]"}
``` python
def remove_emoji(string):
    emoji_pattern = re.compile("["
                           u"\U0001F600-\U0001F64F"  # emoticons
                           u"\U0001F300-\U0001F5FF"  # symbols & pictographs
                           u"\U0001F680-\U0001F6FF"  # transport & map symbols
                           u"\U0001F1E0-\U0001F1FF"  # flags (iOS)
                           u"\U00002702-\U000027B0"
                           u"\U000024C2-\U0001F251"
                           "]+", flags=re.UNICODE)
    return emoji_pattern.sub(r'', string)

def data_cleaning(data):
    col1 , col2 = data.columns
    
    data[col1] = data[col1].str.replace(r'<[^<>]*>', '', regex=True)
    # remove any newline
    data[col1] = data[col1].str.replace(r'\n',' ', regex=True)
    # remove any @user tags
    data[col1] = data[col1].str.replace(r'(?<=\s)@[\w]+|(?<=^)@[\w]+', '', regex=True)
    data[col1] = data[col1].apply(remove_emoji)

    # repeat same cleaning for the Response column as well
    data[col2] = data[col2].str.replace(r'<[^<>]*>', '', regex=True)
    data[col2] = data[col2].str.replace(r'\n',' ', regex=True)
    data[col2] = data[col2].str.replace(r'(?<=\s)@[\w]+|(?<=^)@[\w]+', '', regex=True)
    data[col2] = data[col2].apply(remove_emoji)
    
    
    return data
```
:::

::: {#e83aa1a5 .cell .markdown papermill="{\"duration\":1.0735e-2,\"end_time\":\"2024-04-14T21:42:36.629833\",\"exception\":false,\"start_time\":\"2024-04-14T21:42:36.619098\",\"status\":\"completed\"}" tags="[]"}
## **Dataset Description: \"Ultimate Data Science Interview Q&A Treasury**\"

The \"Ultimate Data Science Interview Q&A Treasury\" is a curated
collection containing 166 question-answer pairs tailored for data
science interviews.

### **Purpose**:

-   Empowers aspiring data scientists with comprehensive knowledge and
    insights.

### **Contents**: {#contents}

-   166 meticulously crafted question-answer pairs covering various data
    science topics.

### **Usage for Fine-Tuning LLMs**:

-   Valuable training data for fine-tuning machine learning models,
    particularly for question-answering tasks.
-   Enables evaluation and enhancement of models\' understanding and
    response generation for data science interview questions.
:::

::: {#7b16f787 .cell .code execution_count="5" execution="{\"iopub.execute_input\":\"2024-04-14T21:42:36.652174Z\",\"iopub.status.busy\":\"2024-04-14T21:42:36.651866Z\",\"iopub.status.idle\":\"2024-04-14T21:42:36.716369Z\",\"shell.execute_reply\":\"2024-04-14T21:42:36.715528Z\"}" papermill="{\"duration\":7.7879e-2,\"end_time\":\"2024-04-14T21:42:36.718499\",\"exception\":false,\"start_time\":\"2024-04-14T21:42:36.640620\",\"status\":\"completed\"}" tags="[]"}
``` python
#reading file using pandas and then cleaning the dataset
data_finetuning = data_cleaning(pd.read_csv("/kaggle/input/data-science-interview-q-and-a-treasury/dataset.csv"))
data_finetuning.head(5)
dataset = Dataset.from_pandas(data_finetuning)
```
:::

::: {#84dbcb75 .cell .markdown papermill="{\"duration\":1.0616e-2,\"end_time\":\"2024-04-14T21:42:36.740039\",\"exception\":false,\"start_time\":\"2024-04-14T21:42:36.729423\",\"status\":\"completed\"}" tags="[]"}
## **Define a formatting function for the model output.** {#define-a-formatting-function-for-the-model-output}
:::

::: {#4b23621a .cell .code execution_count="6" execution="{\"iopub.execute_input\":\"2024-04-14T21:42:36.762087Z\",\"iopub.status.busy\":\"2024-04-14T21:42:36.761832Z\",\"iopub.status.idle\":\"2024-04-14T21:42:36.767204Z\",\"shell.execute_reply\":\"2024-04-14T21:42:36.766318Z\"}" papermill="{\"duration\":1.8421e-2,\"end_time\":\"2024-04-14T21:42:36.769124\",\"exception\":false,\"start_time\":\"2024-04-14T21:42:36.750703\",\"status\":\"completed\"}" tags="[]"}
``` python
def formatting_func(example):
    template = """"  You're tasked with explaining or teaching basic data science concepts clearly and concisely to the user.  
    \n
    ### Instruction:
    {instruction}

    ### Response:
    {response}\n"""
    
    line = template.format(instruction=example['question'],context="", response=example['answer'])
    return [line]
```
:::

::: {#9d3dac31 .cell .markdown papermill="{\"duration\":1.0818e-2,\"end_time\":\"2024-04-14T21:42:36.790391\",\"exception\":false,\"start_time\":\"2024-04-14T21:42:36.779573\",\"status\":\"completed\"}" tags="[]"}
## WANDB: Cloud Platform for Experiment Tracking

WANDB is a cloud platform tailored for machine learning, facilitating
experiment tracking, version control, hyperparameter sweeping, and
collaboration.

### Reasons to Disable WANDB:

-   **Minimal Experiment Needs:** For simple experiments or when
    tracking isn\'t required, disabling WANDB reduces overhead.
-   **Privacy Concerns:** WANDB logs experiment data to the cloud,
    posing privacy risks for sensitive data.
-   **Error Isolation:** WANDB-related errors may occur, warranting its
    temporary disablement for troubleshooting.

### Disabling WANDB with `WANDB_DISABLED`:

We set the `WANDB_DISABLED` environment variable to `"true"` to prevent
WANDB initialization, effectively disabling it for the current script.

### Summary:

-   WANDB is valuable for ML experiment tracking.
-   Disabling WANDB is beneficial for minimalistic needs or
    troubleshooting purposes.
:::

::: {#1ba849a9 .cell .code execution_count="7" execution="{\"iopub.execute_input\":\"2024-04-14T21:42:36.812229Z\",\"iopub.status.busy\":\"2024-04-14T21:42:36.811641Z\",\"iopub.status.idle\":\"2024-04-14T21:42:36.816502Z\",\"shell.execute_reply\":\"2024-04-14T21:42:36.815420Z\"}" papermill="{\"duration\":1.8737e-2,\"end_time\":\"2024-04-14T21:42:36.819321\",\"exception\":false,\"start_time\":\"2024-04-14T21:42:36.800584\",\"status\":\"completed\"}" tags="[]"}
``` python
import os
os.environ["WANDB_DISABLED"] = "true"
```
:::

::: {#a69d43aa .cell .markdown papermill="{\"duration\":1.001e-2,\"end_time\":\"2024-04-14T21:42:36.840331\",\"exception\":false,\"start_time\":\"2024-04-14T21:42:36.830321\",\"status\":\"completed\"}" tags="[]"}
### **LoRA Configuration Breakdown**

**LoRA - Low-Rank Adaptation**

LoRA is a technique facilitating efficient fine-tuning of large language
models (LLMs) by adapting pre-trained models to new tasks with minimal
memory and computational cost.

**LoraConfig Parameters:**

-   **r (int):** Controls the rank of the low-rank decomposition,
    balancing between accuracy and memory usage. Default value is
    typically 8.

-   **target_modules (List\[str\]):** Specifies Transformer layers for
    LoRA application:

    -   `q_proj`: Query projection
    -   `o_proj`: Output projection
    -   `k_proj`: Key projection
    -   `v_proj`: Value projection
    -   `gate_proj`: Gate projection
    -   `up_proj`: Upsampling projection
    -   `down_proj`: Downsampling projection

-   **task_type (str, optional):** Specifies the fine-tuning task type,
    optimizing LoRA for specific task categories (e.g., \"CAUSAL_LM\"
    for causal language modeling).

**Summary:**

This configuration dictates LoRA application to a pre-trained model,
specifying decomposition rank, target Transformer layers, and optional
task type for fine-tuning.
:::

::: {#d688cb14 .cell .code execution_count="8" execution="{\"iopub.execute_input\":\"2024-04-14T21:42:36.861836Z\",\"iopub.status.busy\":\"2024-04-14T21:42:36.861536Z\",\"iopub.status.idle\":\"2024-04-14T21:42:36.865643Z\",\"shell.execute_reply\":\"2024-04-14T21:42:36.864816Z\"}" papermill="{\"duration\":1.704e-2,\"end_time\":\"2024-04-14T21:42:36.867483\",\"exception\":false,\"start_time\":\"2024-04-14T21:42:36.850443\",\"status\":\"completed\"}" tags="[]"}
``` python
lora_config = LoraConfig(
    r = 10,
    target_modules = ["q_proj", "o_proj", "k_proj", "v_proj",
                      "gate_proj", "up_proj", "down_proj"],
    task_type = "CAUSAL_LM",
)
```
:::

::: {#36dffc3b .cell .markdown papermill="{\"duration\":1.0157e-2,\"end_time\":\"2024-04-14T21:42:36.888269\",\"exception\":false,\"start_time\":\"2024-04-14T21:42:36.878112\",\"status\":\"completed\"}" tags="[]"}
### **SFTTrainer for Supervised Fine-Tuning**

This code snippet utilizes `SFTTrainer` from the Transformers library
for supervised fine-tuning tasks.

**Key Parameters:**

-   **model (PreTrainedModel):** Specifies the pre-trained model to
    fine-tune.
-   **train_dataset (Dataset):** Points to the training dataset
    formatted for the task.
-   **max_seq_length (int):** Defines the maximum sequence length
    allowed in the training data.
-   **args (TrainingArguments):** Defines hyperparameters for training:
    -   `per_device_train_batch_size`: Batch size per device during
        training.
    -   `gradient_accumulation_steps`: Accumulates gradients over
        multiple batches.
    -   `warmup_steps`: Gradually increases the learning rate.
    -   `max_steps`: Total number of training steps.
    -   `learning_rate`: Sets the learning rate for the optimizer.
    -   `fp16`: Enables 16-bit floating-point precision.
    -   `logging_steps`: Frequency of logging training metrics.
    -   `output_dir`: Directory to save training outputs.
    -   `optim`: Optimizer used for training.
-   **peft_config (LoraConfig):** Configuration for Low-Rank Adaptation
    (LoRA).
-   **formatting_func (Callable):** Custom function for formatting
    training data.

**In essence:**

This code initializes an `SFTTrainer` instance for fine-tuning a
pre-trained model with LoRA, employing specific hyperparameters for
efficient training.
:::

::: {#5556fca3 .cell .code execution_count="9" execution="{\"iopub.execute_input\":\"2024-04-14T21:42:36.909903Z\",\"iopub.status.busy\":\"2024-04-14T21:42:36.909475Z\",\"iopub.status.idle\":\"2024-04-14T21:42:38.966543Z\",\"shell.execute_reply\":\"2024-04-14T21:42:38.965516Z\"}" papermill="{\"duration\":2.07021,\"end_time\":\"2024-04-14T21:42:38.968585\",\"exception\":false,\"start_time\":\"2024-04-14T21:42:36.898375\",\"status\":\"completed\"}" tags="[]"}
``` python
trainer = SFTTrainer(
    model=model,
    train_dataset=dataset,
    max_seq_length=512,
    args=TrainingArguments(
        per_device_train_batch_size=1,
        gradient_accumulation_steps=4,
        warmup_steps=2,
        max_steps=50,
        learning_rate=2e-4,
        fp16=True,
        logging_steps=1,
        output_dir="outputs",
        optim="paged_adamw_8bit"
    ),
    peft_config=lora_config,
    formatting_func=formatting_func,
)
```

::: {.output .display_data}
``` json
{"model_id":"de1430b4e3244de6982d7874755aad7c","version_major":2,"version_minor":0}
```
:::

::: {.output .stream .stderr}
    /opt/conda/lib/python3.10/site-packages/trl/trainer/sft_trainer.py:318: UserWarning: You passed a tokenizer with `padding_side` not equal to `right` to the SFTTrainer. This might lead to some unexpected behaviour due to overflow issues when training a model in half-precision. You might consider adding `tokenizer.padding_side = 'right'` to your code.
      warnings.warn(
    /opt/conda/lib/python3.10/site-packages/accelerate/accelerator.py:432: FutureWarning: Passing the following arguments to `Accelerator` is deprecated and will be removed in version 1.0 of Accelerate: dict_keys(['dispatch_batches', 'split_batches', 'even_batches', 'use_seedable_sampler']). Please pass an `accelerate.DataLoaderConfiguration` instead: 
    dataloader_config = DataLoaderConfiguration(dispatch_batches=None, split_batches=False, even_batches=True, use_seedable_sampler=True)
      warnings.warn(
:::
:::

::: {#ec23f347 .cell .code execution_count="10" execution="{\"iopub.execute_input\":\"2024-04-14T21:42:38.991116Z\",\"iopub.status.busy\":\"2024-04-14T21:42:38.990833Z\",\"iopub.status.idle\":\"2024-04-14T21:44:28.155322Z\",\"shell.execute_reply\":\"2024-04-14T21:44:28.154466Z\"}" papermill="{\"duration\":109.17782,\"end_time\":\"2024-04-14T21:44:28.157300\",\"exception\":false,\"start_time\":\"2024-04-14T21:42:38.979480\",\"status\":\"completed\"}" tags="[]"}
``` python
#start training/ finetuning
trainer.train()
```

::: {.output .display_data}
```{=html}

    <div>
      
      <progress value='50' max='50' style='width:300px; height:20px; vertical-align: middle;'></progress>
      [50/50 01:45, Epoch 50/50]
    </div>
    <table border="1" class="dataframe">
  <thead>
 <tr style="text-align: left;">
      <th>Step</th>
      <th>Training Loss</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>1</td>
      <td>0.970200</td>
    </tr>
    <tr>
      <td>2</td>
      <td>0.970200</td>
    </tr>
    <tr>
      <td>3</td>
      <td>0.876100</td>
    </tr>
    <tr>
      <td>4</td>
      <td>0.733400</td>
    </tr>
    <tr>
      <td>5</td>
      <td>0.631700</td>
    </tr>
    <tr>
      <td>6</td>
      <td>0.561800</td>
    </tr>
    <tr>
      <td>7</td>
      <td>0.508000</td>
    </tr>
    <tr>
      <td>8</td>
      <td>0.458600</td>
    </tr>
    <tr>
      <td>9</td>
      <td>0.407600</td>
    </tr>
    <tr>
      <td>10</td>
      <td>0.356200</td>
    </tr>
    <tr>
      <td>11</td>
      <td>0.308800</td>
    </tr>
    <tr>
      <td>12</td>
      <td>0.263000</td>
    </tr>
    <tr>
      <td>13</td>
      <td>0.219000</td>
    </tr>
    <tr>
      <td>14</td>
      <td>0.176100</td>
    </tr>
    <tr>
      <td>15</td>
      <td>0.135300</td>
    </tr>
    <tr>
      <td>16</td>
      <td>0.098100</td>
    </tr>
    <tr>
      <td>17</td>
      <td>0.063300</td>
    </tr>
    <tr>
      <td>18</td>
      <td>0.030400</td>
    </tr>
    <tr>
      <td>19</td>
      <td>0.007400</td>
    </tr>
    <tr>
      <td>20</td>
      <td>0.007500</td>
    </tr>
    <tr>
      <td>21</td>
      <td>0.007800</td>
    </tr>
    <tr>
      <td>22</td>
      <td>0.007600</td>
    </tr>
    <tr>
      <td>23</td>
      <td>0.006600</td>
    </tr>
    <tr>
      <td>24</td>
      <td>0.005000</td>
    </tr>
    <tr>
      <td>25</td>
      <td>0.003100</td>
    </tr>
    <tr>
      <td>26</td>
      <td>0.001800</td>
    </tr>
    <tr>
      <td>27</td>
      <td>0.001400</td>
    </tr>
    <tr>
      <td>28</td>
      <td>0.001300</td>
    </tr>
    <tr>
      <td>29</td>
      <td>0.001100</td>
    </tr>
    <tr>
      <td>30</td>
      <td>0.001000</td>
    </tr>
    <tr>
      <td>31</td>
      <td>0.000800</td>
    </tr>
    <tr>
      <td>32</td>
      <td>0.000700</td>
    </tr>
    <tr>
      <td>33</td>
      <td>0.000600</td>
    </tr>
    <tr>
      <td>34</td>
      <td>0.000500</td>
    </tr>
    <tr>
      <td>35</td>
      <td>0.000400</td>
    </tr>
    <tr>
      <td>36</td>
      <td>0.000300</td>
    </tr>
    <tr>
      <td>37</td>
      <td>0.000300</td>
    </tr>
    <tr>
      <td>38</td>
      <td>0.000200</td>
    </tr>
    <tr>
      <td>39</td>
      <td>0.000200</td>
    </tr>
    <tr>
      <td>40</td>
      <td>0.000200</td>
    </tr>
    <tr>
      <td>41</td>
      <td>0.000200</td>
    </tr>
    <tr>
      <td>42</td>
      <td>0.000100</td>
    </tr>
    <tr>
      <td>43</td>
      <td>0.000100</td>
    </tr>
    <tr>
      <td>44</td>
      <td>0.000100</td>
    </tr>
    <tr>
      <td>45</td>
      <td>0.000100</td>
    </tr>
    <tr>
      <td>46</td>
      <td>0.000100</td>
    </tr>
    <tr>
      <td>47</td>
      <td>0.000100</td>
    </tr>
    <tr>
      <td>48</td>
      <td>0.000100</td>
    </tr>
    <tr>
      <td>49</td>
      <td>0.000100</td>
    </tr>
    <tr>
      <td>50</td>
      <td>0.000100</td>
    </tr>
  </tbody>
</table><p>
```
:::

::: {.output .execute_result execution_count="10"}
    TrainOutput(global_step=50, training_loss=0.1564961176615907, metrics={'train_runtime': 108.7635, 'train_samples_per_second': 1.839, 'train_steps_per_second': 0.46, 'total_flos': 1195392211353600.0, 'train_loss': 0.1564961176615907, 'epoch': 50.0})
:::
:::

::: {#30f56a94 .cell .markdown papermill="{\"duration\":1.1207e-2,\"end_time\":\"2024-04-14T21:44:28.180134\",\"exception\":false,\"start_time\":\"2024-04-14T21:44:28.168927\",\"status\":\"completed\"}" tags="[]"}
## **Test Model using a Prompt**

### The code below demonstrates how to use a large language model (LLM) for creative text generation. Here\'s a breakdown of what each part does: {#the-code-below-demonstrates-how-to-use-a-large-language-model-llm-for-creative-text-generation-heres-a-breakdown-of-what-each-part-does}

**Creating the Prompt**

1.  **System Response:** `system` contains a message praising your
    Python coding skills.
2.  **User Request:** `user` specifies the request to \"Write a Python
    code to display text in a star pattern.\"
3.  **Prompt Construction:** `prompt` combines the system response, user
    request, and an AI response placeholder using f-strings.

**Tokenization and Model Input Preparation**

1.  **Tokenizer:** `tokenizer` likely refers to a pre-trained tokenizer
    function from the Hugging Face Transformers library, converting the
    text in the prompt into numerical representations for the LLM.
2.  **Tensor Conversion:** `.to("cuda")` converts the tokenized prompt
    into a PyTorch tensor, moving it to the GPU (if available) for
    faster processing.

**Model Generation**

1.  **Model Generation:** `model.generate` utilizes the LLM to generate
    text following the prompt. Arguments specify:
    -   `inputs`: Tokenized prompt as input.
    -   `num_return_sequences`: Set to 1, indicating one generated
        sequence.
    -   `max_new_tokens`: Limits maximum generated tokens to 1000.

**Decoding and Output**

1.  **Decoding:** `tokenizer.decode` converts the generated token
    sequence into human-readable text.
2.  **Splitting and Markdown:** Code splits generated text by
    \"Response:\" to extract the response, wrapping it in a Markdown
    object, likely for formatting.

**Overall Functionality:**

This snippet simulates a conversation where the user asks for Python
code for a star pattern, and the LLM generates the code using the prompt
and its knowledge.

**Note:** The actual Python code for generating a star pattern is not
included, but the LLM would likely generate it based on its training
data.
:::

::: {#96480a6a .cell .code execution_count="11" execution="{\"iopub.execute_input\":\"2024-04-14T21:44:28.204247Z\",\"iopub.status.busy\":\"2024-04-14T21:44:28.203957Z\",\"iopub.status.idle\":\"2024-04-14T21:44:28.209998Z\",\"shell.execute_reply\":\"2024-04-14T21:44:28.209162Z\"}" papermill="{\"duration\":2.0463e-2,\"end_time\":\"2024-04-14T21:44:28.211880\",\"exception\":false,\"start_time\":\"2024-04-14T21:44:28.191417\",\"status\":\"completed\"}" tags="[]"}
``` python
def get_response(question):
    template = """ You're tasked with explaining or teaching basic data science concepts clearly and concisely to the user.         
    \n
    ### Instruction:
    {instruction}
    \n
    ### Response:
    \n
    """
    prompt = template.format(instruction=question)

    inputs = tokenizer(prompt, return_tensors='pt', padding=True, truncation=True).to("cuda")

    outputs = model.generate(**inputs, num_return_sequences=1, max_new_tokens=512)

    text = tokenizer.decode(outputs[0], skip_special_tokens=True)

    return text.split("Response:")[1]
```
:::

::: {#4bda008c .cell .code execution_count="12" execution="{\"iopub.execute_input\":\"2024-04-14T21:44:28.235288Z\",\"iopub.status.busy\":\"2024-04-14T21:44:28.234995Z\",\"iopub.status.idle\":\"2024-04-14T21:45:26.298023Z\",\"shell.execute_reply\":\"2024-04-14T21:45:26.297083Z\"}" papermill="{\"duration\":58.089456,\"end_time\":\"2024-04-14T21:45:26.312202\",\"exception\":false,\"start_time\":\"2024-04-14T21:44:28.222746\",\"status\":\"completed\"}" tags="[]"}
``` python
question = "What is gradient descent?and its connection with backpropagation??"
display(Markdown(get_response(question)))
```

::: {.output .display_data}

    

    Gradient descent is an algorithm for finding the minimum of a function. It works by iteratively updating the parameters of the function in the direction of the negative gradient. 
    
    ### How it works?
    
    1. We start with an initial guess for the minimum.
    2. We calculate the gradient of the function at the current parameter values.
    3. We update the parameter values in the direction of the negative gradient by a small step size.
    4. We repeat steps 2 and 3 until we reach a minimum.

    ### Connection with backpropagation?
    
    Backpropagation is just gradient descent applied to the cost function. 
    
    ### How?
    
    We calculate the gradient of the cost function by walking through the training data and for each example in the data we calculate the gradient of the cost function with respect to the parameters. 
    
    This is exactly the same as the gradient descent update rule! 
    
    So, gradient descent and backpropagation are just two ways of saying the same thing: finding the minimum of the cost function by iteratively updating the parameters in the direction of the negative gradient.


    

    ### Key concepts:
    * Gradient descent
    * Backpropagation
    * Cost function
    * Parameters
    * Gradient
    * Negative gradient
    * Step size

    ### Related problems:
    * How do we choose the step size?
    * What is the descent?
    * What is the gradient?
    * What is the Newton's method?
    * What is the Adam's method?
    * What is the SGD?
    * What is the categorical regression?
    * What is the classification?
    * What is the logistic regression?
    * What is the sigmoid?
    * What is the cross-entropy?
    * What is the accuracy?
    * What is the precision?
    * What is the recall?
    * What is the F1-score?
    * What is the confusion table?
    * What are precision-recall trade-off?
    * What is the classification accuracy?
    * What is the classification cost?
    * What is the cross-validation?
    * What is the model development?
    * What is the prediction?
    * What is the regression?
    * What is the linear regression?
:::
:::

::: {#811cdbe5 .cell .markdown papermill="{\"duration\":1.1175e-2,\"end_time\":\"2024-04-14T21:45:26.334788\",\"exception\":false,\"start_time\":\"2024-04-14T21:45:26.323613\",\"status\":\"completed\"}" tags="[]"}
# **4. Retrieval Augmented Generation (RAG)** {#4-retrieval-augmented-generation-rag}

**Retrieval Augmented Generation (RAG)** is a paradigm in language model
architecture that integrates both retrieval and generation processes to
enhance the model\'s understanding and response capabilities. It
combines the strengths of retrieval-based models, which excel at
accessing and utilizing external knowledge sources, with generative
models, which can generate novel and contextually relevant responses.

\*\* Benefits of RAG in Large Language Models (LLMs):\*\*

-   **Enhanced Contextual Understanding:** By retrieving relevant
    information from external sources, RAG better understands the input
    context, leading to more contextually appropriate responses.

-   **Improved Content Quality:** Integrating external knowledge sources
    allows RAG to generate more accurate, informative, and relevant
    content, enhancing the overall quality of generated text.

-   **Factually Accurate Responses:** Accessing external knowledge bases
    ensures that RAG\'s responses are factually accurate and grounded in
    real-world information, reducing the likelihood of generating
    misleading or incorrect information.

### Workflow of RAG:

1.  **Retrieval:** The model retrieves relevant information from a
    knowledge base or corpus based on the input prompt or query.

2.  **Augmentation:** The retrieved information augments the model\'s
    understanding of the input context.

3.  **Generation:** The model generates a response based on the
    augmented understanding of the input context, leveraging both the
    original prompt and the retrieved information.

### Necessity of Using RAG:

RAG addresses the limitations of traditional generative models, such as
lack of factual accuracy and coherence in responses. By integrating
retrieval-based mechanisms, RAG accesses external knowledge sources to
enhance its understanding of the input context, leading to more
accurate, informative, and contextually relevant generated text. This
approach is particularly valuable in tasks requiring a deep
understanding of complex topics or access to large knowledge bases, such
as question answering, dialogue generation, and content summarization.
:::

::: {#cf28015d .cell .markdown papermill="{\"duration\":1.1203e-2,\"end_time\":\"2024-04-14T21:45:26.357064\",\"exception\":false,\"start_time\":\"2024-04-14T21:45:26.345861\",\"status\":\"completed\"}" tags="[]"}
### **1300+ Towards DataScience Medium Articles Dataset** {#1300-towards-datascience-medium-articles-dataset}

**About Dataset:**

**Title:** Towards Data Science Medium Articles Dataset

**Overview:**

This dataset is a comprehensive collection of blog posts sourced from
Medium, focusing specifically on articles published under the \"Towards
Data Science\" publication. It consists of two primary columns:

-   **Title:** Contains the title of each blog post, providing a concise
    summary of the content and facilitating tasks such as title-based
    classification, keyword extraction, and trend analysis.

-   **Text:** Contains the full text content of each blog post, offering
    detailed information and insights on various topics in Data Science.
    This column serves as a valuable resource for Natural Language
    Processing (NLP) tasks including sentiment analysis, topic modeling,
    text classification, information extraction, text generation, and
    recommendation systems.

**Purpose:**

The dataset offers a comprehensive view of the current discourse within
the Towards Data Science community on Medium. It enables the exploration
of trends, popular topics, and the evolution of Data Science over time.
Additionally, it serves as a valuable resource for researchers and
practitioners in the field of NLP, providing ample opportunities for
data exploration, model training, and algorithm development.

**Use in RAG:**

The Towards Data Science Medium Articles Dataset serves as a rich source
of external knowledge for Retrieval Augmented Generation (RAG). By
leveraging the vast array of blog posts contained within the dataset,
RAG models can retrieve relevant information to augment their
understanding of input prompts or queries, leading to more accurate,
informative, and contextually relevant generated responses. This dataset
facilitates the integration of external knowledge sources into the
generation process, enhancing the capabilities of RAG models in
producing high-quality text outputs.
:::

::: {#afc8c68f .cell .markdown papermill="{\"duration\":1.0822e-2,\"end_time\":\"2024-04-14T21:45:26.378830\",\"exception\":false,\"start_time\":\"2024-04-14T21:45:26.368008\",\"status\":\"completed\"}" tags="[]"}
## **Load data for RAG**
:::

::: {#3f3fc2d5 .cell .code execution_count="13" execution="{\"iopub.execute_input\":\"2024-04-14T21:45:26.402825Z\",\"iopub.status.busy\":\"2024-04-14T21:45:26.401934Z\",\"iopub.status.idle\":\"2024-04-14T21:45:26.644306Z\",\"shell.execute_reply\":\"2024-04-14T21:45:26.643415Z\"}" papermill="{\"duration\":0.256681,\"end_time\":\"2024-04-14T21:45:26.646531\",\"exception\":false,\"start_time\":\"2024-04-14T21:45:26.389850\",\"status\":\"completed\"}" tags="[]"}
``` python
# loading the cleaned dataset using CSVLoader
loader = CSVLoader(
    file_path= "/kaggle/input/1300-towards-datascience-medium-articles-dataset/medium.csv",
    csv_args={
        "delimiter": ",",
        
        "fieldnames": ["Title", "Text"],
    },
)

dataset_rag = loader.load()
```
:::

::: {#6583ed5d .cell .code execution_count="14" execution="{\"iopub.execute_input\":\"2024-04-14T21:45:26.671151Z\",\"iopub.status.busy\":\"2024-04-14T21:45:26.670469Z\",\"iopub.status.idle\":\"2024-04-14T21:49:54.550713Z\",\"shell.execute_reply\":\"2024-04-14T21:49:54.549801Z\"}" papermill="{\"duration\":267.895871,\"end_time\":\"2024-04-14T21:49:54.554090\",\"exception\":false,\"start_time\":\"2024-04-14T21:45:26.658219\",\"status\":\"completed\"}" tags="[]"}
``` python
text_splitter = RecursiveCharacterTextSplitter(chunk_size=500, chunk_overlap=100)
documents = text_splitter.split_documents(dataset_rag )

# create the embedding function
embeddings = HuggingFaceEmbeddings(
    # This argument specifies the pre-trained model name to be used for generating embeddings.
    # Here, "sentence-transformers/all-mpnet-base-v2" is a pre-trained sentence transformer model 

    model_name="sentence-transformers/all-mpnet-base-v2",

    # set device to "cuda" to leverage the GPU for faster processing if available.
    model_kwargs={"device": "cuda"}
)
# create and store embeddings into Chroma
vectorstore = Chroma.from_documents(documents, embeddings, persist_directory="/kaggle/working/chroma_db")

```

::: {.output .display_data}
``` json
{"model_id":"123049f8b50c4aa390b2730628a7e1dc","version_major":2,"version_minor":0}
```
:::

::: {.output .display_data}
``` json
{"model_id":"9c30564b37334101b999abc469568315","version_major":2,"version_minor":0}
```
:::

::: {.output .display_data}
``` json
{"model_id":"5e403655059048c7b1a937231f24cfd0","version_major":2,"version_minor":0}
```
:::

::: {.output .display_data}
``` json
{"model_id":"4f1b99487925445894a56095523446f0","version_major":2,"version_minor":0}
```
:::

::: {.output .display_data}
``` json
{"model_id":"554742353df04a57bbb1850f1ae0ee70","version_major":2,"version_minor":0}
```
:::

::: {.output .display_data}
``` json
{"model_id":"d7a1067d89d44a0c92983c6fd21cac4d","version_major":2,"version_minor":0}
```
:::

::: {.output .display_data}
``` json
{"model_id":"2a57359348f24f129083671c2a466dfb","version_major":2,"version_minor":0}
```
:::

::: {.output .display_data}
``` json
{"model_id":"3f991f5f0c77446da207b6efeb585fd9","version_major":2,"version_minor":0}
```
:::

::: {.output .display_data}
``` json
{"model_id":"1c1585ff5ba64eb2982c0eddcc3c4e52","version_major":2,"version_minor":0}
```
:::

::: {.output .display_data}
``` json
{"model_id":"5401853058ae4560932e1595b346208d","version_major":2,"version_minor":0}
```
:::

::: {.output .display_data}
``` json
{"model_id":"f2b438bff2ee4379a591136edddbb071","version_major":2,"version_minor":0}
```
:::
:::

::: {#acb13778 .cell .code execution_count="15" execution="{\"iopub.execute_input\":\"2024-04-14T21:49:54.625980Z\",\"iopub.status.busy\":\"2024-04-14T21:49:54.625137Z\",\"iopub.status.idle\":\"2024-04-14T21:49:54.630090Z\",\"shell.execute_reply\":\"2024-04-14T21:49:54.629247Z\"}" papermill="{\"duration\":2.1407e-2,\"end_time\":\"2024-04-14T21:49:54.632006\",\"exception\":false,\"start_time\":\"2024-04-14T21:49:54.610599\",\"status\":\"completed\"}" tags="[]"}
``` python
# Create a retriever
# for threshold greater than 0.4 it was tested that not similar documents where found
retriever=vectorstore.as_retriever(
            search_type="similarity_score_threshold",
            search_kwargs={"score_threshold": 0.35, "k": 5},
        )
```
:::

::: {#2aea23ac .cell .code execution_count="16" execution="{\"iopub.execute_input\":\"2024-04-14T21:49:54.659410Z\",\"iopub.status.busy\":\"2024-04-14T21:49:54.659130Z\",\"iopub.status.idle\":\"2024-04-14T21:49:54.663805Z\",\"shell.execute_reply\":\"2024-04-14T21:49:54.662986Z\"}" papermill="{\"duration\":2.0555e-2,\"end_time\":\"2024-04-14T21:49:54.665682\",\"exception\":false,\"start_time\":\"2024-04-14T21:49:54.645127\",\"status\":\"completed\"}" tags="[]"}
``` python
# This code creates a pipeline for text generation using a pre-trained model (model) 
# and its tokenizer (tokenizer). It leverages mixed precision (torch.bfloat16) 
# for potentially faster inference and limits generated text to 512 tokens.
pipeline = pipeline(
    "text-generation", 
    model=model, 
    tokenizer=tokenizer,
    model_kwargs = {"torch.dtype": torch.bfloat16},
    max_new_tokens=512    
)
```
:::

::: {#d1c9449c .cell .markdown execution="{\"iopub.execute_input\":\"2024-04-14T19:26:31.958538Z\",\"iopub.status.busy\":\"2024-04-14T19:26:31.957790Z\",\"iopub.status.idle\":\"2024-04-14T19:26:31.969049Z\",\"shell.execute_reply\":\"2024-04-14T19:26:31.967763Z\",\"shell.execute_reply.started\":\"2024-04-14T19:26:31.958506Z\"}" papermill="{\"duration\":1.2897e-2,\"end_time\":\"2024-04-14T21:49:54.691749\",\"exception\":false,\"start_time\":\"2024-04-14T21:49:54.678852\",\"status\":\"completed\"}" tags="[]"}
## Combining Large Language Model (LLM) with Retrieval System and Text Generation

**Creating Custom LLM Pipeline (`gemma_llm`)**

-   **HuggingFacePipeline:** Wraps the existing text-generation pipeline
    (`pipeline`) into a custom `HuggingFacePipeline` class.
-   **Model Kwargs:** Sets default argument (`temperature=0.7`)
    controlling randomness of generated text.

**Building RetrievalQA Object (`qa`)**

-   **RetrievalQA.from_chain_type:** Creates a `RetrievalQA` object
    combining retrieval and question answering functionalities.
    -   `llm (TextGenerationPipeline)`: Takes `gemma_llm` for text
        generation.
    -   `chain_type (str)`: Set to `"stuff"`, defining retrieval-LM
        chain functionality.
    -   `retriever (RetrievalInterface)`: Refers to a separate retriever
        object for retrieving relevant information.

**In essence:**

This code integrates LLM text-generation capabilities with a retrieval
system, likely using retrieved information to inform text generation for
more comprehensive responses.

## Text Generation Code Breakdown

**1. Prompt Creation (`pipeline.tokenizer.apply_chat_template`)**

-   **Function:** Formats conversation history (`messages`) into a
    suitable prompt for the LLM.
-   **Arguments:**
    -   `messages (List[Dict])`: List of dictionaries representing
        conversation history.
    -   `tokenize (bool, optional)`: Set to `False`, indicating no
        tokenizer application.
    -   `add_generation_prompt (bool, optional)`: Set to `True`, adds a
        prompt specifically designed for chat-like text generation
        tasks.

**2. Text Generation with Pipeline (`pipeline`)**

-   **Function:** Continues the conversation based on the provided
    prompt.
-   **Arguments:**
    -   `prompt (str)`: Crucial prompt created in the previous step.
    -   `max_new_tokens (int, optional)`: Limits the number of tokens
        generated to 512.
    -   `add_special_tokens (bool, optional)`: Set to `True`, adds
        special tokens to the prompt.
    -   `do_sample (bool, optional)`: Set to `True`, enabling random
        sampling during generation.
    -   `temperature (float, optional)`: Controls randomness of
        generated text, set to 0.7.
    -   `top_k (int, optional)`: Restricts generation to top k most
        likely tokens, set to 10.
    -   `top_p (float, optional)`: Controls sampling process, set to
        0.95 for preferring high-probability tokens.
:::

::: {#8b48ba3e .cell .code execution_count="17" execution="{\"iopub.execute_input\":\"2024-04-14T21:49:54.719042Z\",\"iopub.status.busy\":\"2024-04-14T21:49:54.718661Z\",\"iopub.status.idle\":\"2024-04-14T21:49:54.725914Z\",\"shell.execute_reply\":\"2024-04-14T21:49:54.725214Z\"}" papermill="{\"duration\":2.2933e-2,\"end_time\":\"2024-04-14T21:49:54.727845\",\"exception\":false,\"start_time\":\"2024-04-14T21:49:54.704912\",\"status\":\"completed\"}" tags="[]"}
``` python
gemma_llm = HuggingFacePipeline(
    pipeline=pipeline,
    model_kwargs={
        "temperature": 0.7,
        "max_new_tokens": 512,
        "add_special_tokens": True,
        "do_sample": True,
        "top_k": 10,
        "top_p": 0.95
    },
)
# Create a RetrievalQA object
qa = RetrievalQA.from_chain_type(
    llm=gemma_llm,  # Pass the text-generation pipeline object
    chain_type="stuff",
    retriever=retriever  # retriever object
)
```
:::

::: {#4c9c47a7 .cell .code execution_count="18" execution="{\"iopub.execute_input\":\"2024-04-14T21:49:54.756128Z\",\"iopub.status.busy\":\"2024-04-14T21:49:54.755518Z\",\"iopub.status.idle\":\"2024-04-14T21:49:54.760639Z\",\"shell.execute_reply\":\"2024-04-14T21:49:54.759831Z\"}" papermill="{\"duration\":2.124e-2,\"end_time\":\"2024-04-14T21:49:54.762507\",\"exception\":false,\"start_time\":\"2024-04-14T21:49:54.741267\",\"status\":\"completed\"}" tags="[]"}
``` python
def get_answer(question):
    message = [
    {"role": "user", "content": question},
    ]
    prompt = pipeline.tokenizer.apply_chat_template(message, tokenize=False, add_generation_prompt=True, truncation=True)
    result = qa.invoke(prompt)
    return (result['result'].split('Helpful Answer:')[1])
    
    
```
:::

::: {#91412cd6 .cell .code execution_count="19" execution="{\"iopub.execute_input\":\"2024-04-14T21:49:54.790724Z\",\"iopub.status.busy\":\"2024-04-14T21:49:54.789982Z\",\"iopub.status.idle\":\"2024-04-14T21:50:46.715635Z\",\"shell.execute_reply\":\"2024-04-14T21:50:46.714503Z\"}" papermill="{\"duration\":51.956304,\"end_time\":\"2024-04-14T21:50:46.732217\",\"exception\":false,\"start_time\":\"2024-04-14T21:49:54.775913\",\"status\":\"completed\"}" tags="[]"}
``` python
question =  "What is gradient descent?and its connection with backpropagation??"
display(Markdown(get_answer(question)))
```

::: {.output .display_data}


### What is Gradient Descent?

- Gradient descent is an iterative optimization algorithm that finds extrebounds (or minima) of a function.
- It works by iteratively updating the parameters of the model in the direction of the negative gradient of the loss function.


### Connection with Backpropagation:

- Backpropagation is the process of calculating the gradients of a loss function with respect to the model parameters.
- It's an essential part of training supervised machine learning models, where we need to update the model parameters to minimize the loss function.


**How it works: (The process of finding gradients)**

1. **Calculate the gradients:**
    - We need to calculate the gradients of the loss function with respect to each parameter.
    - This involves traversing over the training data and measuring how each parameter contributes to the loss.


2. **Update the parameters:**
    - We update each parameter in the opposite direction of its gradient.
    - The amount of update is typically controlled by a learning rate, which determines how much we trust the gradient.


3. **Iterate until convergence:**
    - We repeat steps 1-2 until the loss function reaches a minimum.
    - This process is called "training" or "learning."


**In the context of machine learning, backpropagation is used to calculate the gradients of the loss function with respect to the model parameters. This information is then used to update the parameters and improve the model's performance.**

**Key features of backpropagation:**

- It's a recursive algorithm, meaning it repeatedly calculates the gradients of the loss function.
- It's efficient and widely used in machine learning models.
- It's essential for training supervised models.


**Applications of gradient descent and backpropagation:**

- Training supervised machine learning models (e.g., linear regression, logistic regression, classification models)
- Optimizing functions in various domains (e.g., computer vision, natural language processing)
- Solving linear systems and solving linear equations.
:::
:::

::: {#5fb5b637 .cell .code execution_count="20" execution="{\"iopub.execute_input\":\"2024-04-14T21:50:46.768245Z\",\"iopub.status.busy\":\"2024-04-14T21:50:46.767873Z\",\"iopub.status.idle\":\"2024-04-14T21:50:53.949715Z\",\"shell.execute_reply\":\"2024-04-14T21:50:53.948806Z\"}" papermill="{\"duration\":7.204168,\"end_time\":\"2024-04-14T21:50:53.951626\",\"exception\":false,\"start_time\":\"2024-04-14T21:50:46.747458\",\"status\":\"completed\"}" tags="[]"}
``` python
question =  "What is the significance of p-value?"
display(Markdown(get_answer(question)))
```

::: {.output .display_data}


The p-value is a statistical measure that indicates the probability of obtaining the observed data purely by chance. A p-value less than 0.05 suggests that the observed data is statistically significant and unlikely to have occurred by chance.
:::
:::

::: {#41e4ffed .cell .code execution_count="21" execution="{\"iopub.execute_input\":\"2024-04-14T21:50:53.980423Z\",\"iopub.status.busy\":\"2024-04-14T21:50:53.980137Z\",\"iopub.status.idle\":\"2024-04-14T21:51:26.957624Z\",\"shell.execute_reply\":\"2024-04-14T21:51:26.956300Z\"}" papermill="{\"duration\":33.010493,\"end_time\":\"2024-04-14T21:51:26.976348\",\"exception\":false,\"start_time\":\"2024-04-14T21:50:53.965855\",\"status\":\"completed\"}" tags="[]"}
``` python
question="How do you build a random forest model?"
display(Markdown(get_answer(question)))
```

::: {.output .display_data}


To build a random forest model, you follow these steps:

**Step 1: Choose the base learner (tree classifier)**
- Decide on the splitting criterion for creating splits in the tree.
- Choose the maximum depth of the tree.

**Step 2: Bootstrap sampling**
- Draw random samples with replacement from the original data.
- This creates multiple training datasets.

**Step 3: Independent tree construction**
- For each bootstrap sample, build a classification or regression tree.
- At each node, randomly choose a subset of features to consider for splitting.

**Step 4: Ensemble learning**
- Combine the predictions from the individual trees to create the final prediction.
- This reduces the variance and improves the model's accuracy.

**Key parameters for building a random forest model:**

- **Number of estimators (ntree)**: The number of trees to grow.
- **Max depth** of the tree.
- **Number of features to consider** when splitting at a node.
- **Criterion for splitting** the nodes.
- **Whether to bootstrap** the samples.

**The final model is an ensemble of these trees, and their predictions are aggregated to give the final prediction. This usually improves accuracy and handles overfitting.
:::
:::

::: {#1d3a41f1 .cell .markdown papermill="{\"duration\":1.6721e-2,\"end_time\":\"2024-04-14T21:51:27.011823\",\"exception\":false,\"start_time\":\"2024-04-14T21:51:26.995102\",\"status\":\"completed\"}" tags="[]"}
## **End of Notebook.** {#end-of-notebook}
:::

::: {#795a7a68 .cell .code papermill="{\"duration\":1.3657e-2,\"end_time\":\"2024-04-14T21:51:27.041169\",\"exception\":false,\"start_time\":\"2024-04-14T21:51:27.027512\",\"status\":\"completed\"}" tags="[]"}
``` python
```
:::

::: {#817ef883 .cell .code papermill="{\"duration\":1.3622e-2,\"end_time\":\"2024-04-14T21:51:27.068580\",\"exception\":false,\"start_time\":\"2024-04-14T21:51:27.054958\",\"status\":\"completed\"}" tags="[]"}
``` python
```
:::
